import{C as z,l as N,i as T,x as W,g as d,o as n,a as v,u as o,m as q,w as P,b as e,e as A,h as c,F as b,s as k,t as m,j as u,k as y,v as K,n as w,P as J,f as H,W as Q}from"./app-BE1RfCb_.js";import{A as X}from"./AuthenticatedLayout-CXgIfDxa.js";import{S as h}from"./sweetalert2.esm.all-B0Dix5B2.js";import{_ as Y}from"./BreadcrumbComponent-Br1Ozxjx.js";import"./ApplicationLogo-CRvW0blS.js";import"./LoadingComponent-RLCIfO3L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AntdIcon-7-HK-o5r.js";const Z={class:"pb-12 pt-6"},ee={class:"max-w-9xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6 text-gray-900"},oe={key:0,class:"mb-4 rounded-md border border-red-200 bg-red-50 p-3"},ae={class:"list-disc pl-5 text-sm text-red-700 space-y-1"},re={class:"grid grid-cols-1 gap-6"},ie={key:0,class:"mt-1 text-sm text-red-600"},de={key:0,class:"mt-1 text-sm text-red-600"},ne={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},le={class:"space-y-1 text-center"},ce={key:0,class:"flex gap-4 mb-4"},me=["src"],pe=["onClick"],ge={class:"text-sm text-gray-600"},ue={class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},_e={key:0,class:"mt-1 text-sm text-red-600"},ye={class:"hidden"},fe={key:0,class:"mt-1 text-sm text-red-600"},xe={class:"grid grid-cols-2 gap-6"},be={key:0,class:"mt-1 text-sm text-red-600"},ke={key:0,class:"mt-1 text-sm text-red-600"},he={class:"grid grid-cols-7 gap-2"},ve=["id","value"],we=["for"],Ue={key:0,class:"mt-1 text-sm text-red-600"},Pe={key:0,class:"mt-1 text-sm text-red-600"},Re={key:0,class:"mt-1 text-sm text-red-600"},je={class:"grid grid-cols-2 gap-6"},De=["max"],Ce={key:0,class:"mt-1 text-sm text-red-600"},Le=["min"],Ve={key:0,class:"mt-1 text-sm text-red-600"},Oe={key:1,class:"mt-1 text-sm text-red-600"},Ie={class:"mt-6 border-t border-gray-600 pt-6"},Me={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},$e={class:"text-sm text-red-600"},Ee={class:"overflow-x-auto"},Se={class:"min-w-full divide-y divide-gray-200"},Be={class:"bg-white divide-y divide-gray-200"},Fe={class:"px-6 py-4 whitespace-nowrap"},Ge=["onUpdate:modelValue"],ze={key:0,class:"mt-1 text-sm text-red-600"},Ne={class:"px-6 py-4 whitespace-nowrap"},Te=["onUpdate:modelValue"],We={key:0,class:"mt-1 text-sm text-red-600"},qe={class:"px-6 py-4"},Ae=["onUpdate:modelValue"],Ke={class:"px-6 py-4"},Je={class:"space-y-2"},He={key:0,class:"flex flex-wrap gap-2"},Qe=["src"],Xe=["onClick"],Ye={class:"flex justify-center border-2 border-gray-300 border-dashed rounded-md"},Ze={class:"space-y-1 text-center"},et={class:"text-sm text-gray-600"},tt=["for"],st=["id","onChange"],ot={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},at=["onClick"],rt={class:"mt-6 flex justify-end"},it=["disabled"],_t={__name:"Duplicate",props:{package:Object},setup(j){const p=j,s=z({name:p.package.name,description:p.package.description,images:p.package.images||[],display_price_adult:p.package.display_price_adult,display_price_child:p.package.display_price_child,package_min_days:p.package.package_min_days,package_max_days:p.package.package_max_days,weekend_days:p.package.weekend_days||[0,6],terms_and_conditions:p.package.terms_and_conditions,location:p.package.location,package_start_date:p.package.package_start_date,package_end_date:p.package.package_end_date,room_types:p.package.room_types.map(i=>({name:i.name,max_occupancy:i.max_occupancy,description:i.description,images:i.images||[],imagePreviews:(i.images||[]).map(t=>`/images/${t}`)}))}),x=N(""),D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=()=>{s.room_types.push({name:"",max_occupancy:4,description:"",images:[],imagePreviews:[]})},L=i=>{s.room_types[i].imagePreviews&&s.room_types[i].imagePreviews.forEach(t=>{t&&t.startsWith("blob:")&&URL.revokeObjectURL(t)}),s.room_types.splice(i,1)},V=i=>{s.icon_photo=i.target.files[0]},O=i=>{const t=Array.from(i.target.files),a=10*1024*1024,r=["image/jpeg","image/png","image/gif"],g=[];if(t.forEach(l=>{r.includes(l.type)||g.push(`${l.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),l.size>a&&g.push(`${l.name} is too large. Maximum file size is 10MB.`)}),g.length>0){h.fire({title:"Invalid Images",html:g.join("<br>"),icon:"error",confirmButtonText:"OK"});return}s.images=[...s.images,...t]},I=i=>{s.images[i],s.images.splice(i,1)},M=i=>typeof i=="string"?`/images/${i}`:typeof window<"u"&&window.URL&&window.URL.createObjectURL?URL.createObjectURL(i):"",$=(i,t)=>{const a=Array.from(i.target.files),r=10*1024*1024,g=["image/jpeg","image/png","image/gif"],l=[];if(a.forEach(_=>{g.includes(_.type)||l.push(`${_.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),_.size>r&&l.push(`${_.name} is too large. Maximum file size is 10MB.`)}),l.length>0){h.fire({title:"Invalid Images",html:l.join("<br>"),icon:"error",confirmButtonText:"OK"});return}s.room_types[t].images=[...s.room_types[t].images||[],...a],a.forEach(_=>{s.room_types[t].imagePreviews||(s.room_types[t].imagePreviews=[]),s.room_types[t].imagePreviews.push(URL.createObjectURL(_))})},E=(i,t)=>{const a=s.room_types[i].imagePreviews[t];s.room_types[i].images.splice(t,1),a&&a.startsWith("blob:")&&URL.revokeObjectURL(a),s.room_types[i].imagePreviews.splice(t,1)},R=()=>{if(x.value="",s.package_start_date&&s.package_end_date){const i=new Date(s.package_start_date),t=new Date(s.package_end_date),a=Math.abs(t-i),r=Math.ceil(a/(1e3*60*60*24));t<=i?x.value="End date must be after start date":r<1&&(x.value="End date must be at least one day after start date")}},S=()=>{const t=["image/jpeg","image/png","image/gif"],a=[];if(s.images.forEach(r=>{r instanceof File&&(t.includes(r.type)||a.push(`${r.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),r.size>10485760&&a.push(`${r.name} is too large. Maximum file size is 10MB.`))}),a.length>0){h.fire({title:"Invalid Images",html:a.join("<br>"),icon:"error",confirmButtonText:"OK"});return}if(R(),x.value){h.fire({title:"Validation Error",text:x.value,icon:"error",confirmButtonText:"OK"});return}s.transform(r=>{const g=r.images.filter(f=>typeof f=="string"),l=r.images.filter(f=>f instanceof File),_=r.room_types.map(f=>{const F=(f.images||[]).filter(U=>typeof U=="string"),G=(f.images||[]).filter(U=>U instanceof File);return{name:f.name,max_occupancy:f.max_occupancy,description:f.description,existing_images:F,images:G}});return{...r,existing_images:g,images:l,room_types:_}}).post(route("packages.duplicate",p.package.id),{onSuccess:()=>{h.fire({title:"Success!",text:"Package has been duplicated successfully.",icon:"success",confirmButtonText:"OK"}).then(()=>{Q.visit(route("packages.index"))})},onError:r=>{console.log("Validation errors:",r)}})},B=T(()=>[{title:"Packages",link:route("packages.index")},{title:"Duplicate Package"}]);return W(()=>{s.images.forEach(i=>{if(i instanceof File){const t=URL.createObjectURL(i);URL.revokeObjectURL(t)}}),s.room_types.forEach(i=>{i.imagePreviews&&i.imagePreviews.forEach(t=>{t&&typeof t=="string"&&t.startsWith("blob:")&&URL.revokeObjectURL(t)})})}),(i,t)=>(n(),d(b,null,[v(o(q),{title:"Duplicate Package"}),v(X,null,{header:P(()=>t[9]||(t[9]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},null,-1)])),default:P(()=>[e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[v(Y,{breadcrumbs:B.value,class:"mb-9"},null,8,["breadcrumbs"]),e("form",{onSubmit:A(S,["prevent"])},[Object.keys(o(s).errors).length>0&&!o(s).errors.general?(n(),d("div",oe,[e("ul",ae,[i.key!=="general"?(n(!0),d(b,{key:0},k(o(s).errors,(a,r)=>(n(),d("li",{key:r},m(a),1))),128)):c("",!0)])])):c("",!0),e("div",re,[e("div",null,[t[10]||(t[10]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),u(e("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=a=>o(s).name=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[y,o(s).name]]),o(s).errors.name?(n(),d("div",ie,m(o(s).errors.name),1)):c("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),u(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=a=>o(s).description=a),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,o(s).description]]),o(s).errors.description?(n(),d("div",de,m(o(s).errors.description),1)):c("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Package Images",-1)),e("div",ne,[e("div",le,[o(s).images&&o(s).images.length>0?(n(),d("div",ce,[(n(!0),d(b,null,k(o(s).images,(a,r)=>(n(),d("div",{key:r,class:"relative group"},[e("img",{src:M(a),class:"h-24 w-full object-cover rounded-lg",alt:"Package image"},null,8,me),e("button",{type:"button",onClick:g=>I(r),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition-opacity"},t[12]||(t[12]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,pe)]))),128))])):c("",!0),e("div",ge,[e("label",ue,[t[13]||(t[13]=e("span",null,"Upload Images",-1)),e("input",{type:"file",onChange:O,accept:"image/*",multiple:"",class:"sr-only"},null,32)])]),t[14]||(t[14]=e("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 10MB",-1))])]),o(s).errors.images?(n(),d("div",_e,m(o(s).errors.images),1)):c("",!0)]),e("div",ye,[t[16]||(t[16]=e("label",{for:"icon_photo",class:"block text-sm font-medium text-gray-700"},"Icon Photo",-1)),e("input",{type:"file",id:"icon_photo",onChange:V,accept:"image/*",class:"mt-1 block w-full"},null,32),o(s).errors.icon_photo?(n(),d("div",fe,m(o(s).errors.icon_photo),1)):c("",!0)]),e("div",xe,[e("div",null,[t[17]||(t[17]=e("label",{for:"display_price_adult",class:"block text-sm font-medium text-gray-700"},"Display Price",-1)),u(e("input",{type:"number",id:"display_price_adult","onUpdate:modelValue":t[2]||(t[2]=a=>o(s).display_price_adult=a),step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,o(s).display_price_adult]]),o(s).errors.display_price_adult?(n(),d("div",be,m(o(s).errors.display_price_adult),1)):c("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{for:"package_min_days",class:"block text-sm font-medium text-gray-700"},"Package Duration (Nights)",-1)),u(e("input",{type:"number",id:"package_min_days","onUpdate:modelValue":t[3]||(t[3]=a=>o(s).package_min_days=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[y,o(s).package_min_days]]),o(s).errors.package_min_days?(n(),d("div",ke,m(o(s).errors.package_min_days),1)):c("",!0)])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Weekend Days",-1)),e("div",he,[(n(),d(b,null,k(D,(a,r)=>e("div",{key:r,class:"flex items-center"},[u(e("input",{type:"checkbox",id:"day-"+r,value:r,"onUpdate:modelValue":t[4]||(t[4]=g=>o(s).weekend_days=g),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,8,ve),[[K,o(s).weekend_days]]),e("label",{for:"day-"+r,class:"ml-2 text-sm text-gray-700"},m(a),9,we)])),64))]),t[20]||(t[20]=e("p",{class:"mt-1 text-sm text-gray-500"},"Select which days are considered weekends for pricing purposes.",-1)),o(s).errors.weekend_days?(n(),d("div",Ue,m(o(s).errors.weekend_days),1)):c("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{for:"terms_and_conditions",class:"block text-sm font-medium text-gray-700"},"Terms and Conditions",-1)),u(e("textarea",{id:"terms_and_conditions","onUpdate:modelValue":t[5]||(t[5]=a=>o(s).terms_and_conditions=a),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,o(s).terms_and_conditions]]),o(s).errors.terms_and_conditions?(n(),d("div",Pe,m(o(s).errors.terms_and_conditions),1)):c("",!0)]),e("div",null,[t[22]||(t[22]=e("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Location",-1)),u(e("input",{type:"text",id:"location","onUpdate:modelValue":t[6]||(t[6]=a=>o(s).location=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,o(s).location]]),o(s).errors.location?(n(),d("div",Re,m(o(s).errors.location),1)):c("",!0)]),e("div",je,[e("div",null,[t[23]||(t[23]=e("label",{for:"package_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),u(e("input",{type:"date",id:"package_start_date","onUpdate:modelValue":t[7]||(t[7]=a=>o(s).package_start_date=a),max:o(s).package_end_date?o(s).package_end_date:void 0,class:w(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.package_start_date||o(s).errors.package_end_date}]),required:"",onChange:R},null,42,De),[[y,o(s).package_start_date]]),o(s).errors.package_start_date?(n(),d("div",Ce,m(o(s).errors.package_start_date),1)):c("",!0)]),e("div",null,[t[24]||(t[24]=e("label",{for:"package_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),u(e("input",{type:"date",id:"package_end_date","onUpdate:modelValue":t[8]||(t[8]=a=>o(s).package_end_date=a),min:o(s).package_start_date?new Date(new Date(o(s).package_start_date).getTime()+864e5).toISOString().split("T")[0]:void 0,class:w(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors.package_end_date}]),required:""},null,10,Le),[[y,o(s).package_end_date]]),o(s).errors.package_end_date?(n(),d("div",Ve,m(o(s).errors.package_end_date),1)):c("",!0),x.value?(n(),d("div",Oe,m(x.value),1)):c("",!0)])]),e("div",Ie,[e("div",{class:"flex justify-between items-center mb-4"},[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-gray-900"},"Room Types",-1)),e("button",{type:"button",onClick:C,class:"px-4 py-2 text-xs bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200"}," Add Room Type ")]),o(s).errors.room_types?(n(),d("div",Me,[e("div",$e,m(o(s).errors.room_types),1)])):c("",!0),e("div",Ee,[e("table",Se,[t[29]||(t[29]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Max Occupancy"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Images"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Be,[(n(!0),d(b,null,k(o(s).room_types,(a,r)=>{var g;return n(),d("tr",{key:r},[e("td",Fe,[u(e("input",{type:"text","onUpdate:modelValue":l=>a.name=l,class:w(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors[`room_types.${r}.name`]}]),placeholder:"Room Type Name",required:""},null,10,Ge),[[y,a.name]]),o(s).errors[`room_types.${r}.name`]?(n(),d("div",ze,m(o(s).errors[`room_types.${r}.name`]),1)):c("",!0)]),e("td",Ne,[u(e("input",{type:"number","onUpdate:modelValue":l=>a.max_occupancy=l,class:w(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":o(s).errors[`room_types.${r}.max_occupancy`]}]),min:"1",required:""},null,10,Te),[[y,a.max_occupancy]]),o(s).errors[`room_types.${r}.max_occupancy`]?(n(),d("div",We,m(o(s).errors[`room_types.${r}.max_occupancy`]),1)):c("",!0)]),e("td",qe,[u(e("input",{type:"text","onUpdate:modelValue":l=>a.description=l,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Description"},null,8,Ae),[[y,a.description]])]),e("td",Ke,[e("div",Je,[(g=a.imagePreviews)!=null&&g.length?(n(),d("div",He,[(n(!0),d(b,null,k(a.imagePreviews,(l,_)=>(n(),d("div",{key:_,class:"relative"},[e("img",{src:l,class:"h-20 w-20 object-cover rounded"},null,8,Qe),e("button",{type:"button",onClick:f=>E(r,_),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},t[26]||(t[26]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Xe)]))),128))])):c("",!0),e("div",Ye,[e("div",Ze,[e("div",et,[e("label",{for:"room-type-images-"+r,class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},[t[27]||(t[27]=e("span",null,"Upload images",-1)),e("input",{id:"room-type-images-"+r,type:"file",multiple:"",accept:"image/*",class:"sr-only",onChange:l=>$(l,r)},null,40,st)],8,tt),t[28]||(t[28]=e("p",{class:"pl-1"},"or drag and drop",-1))])])])])]),e("td",ot,[e("button",{type:"button",onClick:l=>L(r),class:"text-red-600 hover:text-red-900"}," Remove ",8,at)])])}),128))])])])])]),e("div",rt,[v(o(J),{href:i.route("packages.index"),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 mr-3 text-xs"},{default:P(()=>t[30]||(t[30]=[H(" Cancel ")])),_:1},8,["href"]),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:o(s).processing}," Create Duplicate ",8,it)])],32)])])])])]),_:1})],64))}};export{_t as default};
