import{i as S,C,s as D,g as d,o as n,a as _,u as a,m as M,w as b,b as s,e as R,j as g,h as c,k as p,t as m,F as v,q as h,v as B,P as F,f as I,x as N}from"./app-CHTVKYg1.js";import{A}from"./AuthenticatedLayout-DeIG1FF5.js";import{S as y}from"./sweetalert2.esm.all-B0Dix5B2.js";import{_ as G}from"./BreadcrumbComponent-BI3lOB9W.js";import"./ApplicationLogo-DhzfzYGd.js";import"./LoadingComponent-Dulq9Q5h.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AntdIcon-C59AQa1J.js";const q={class:"pb-12 pt-6"},K={class:"max-w-9xl mx-auto sm:px-6 lg:px-8"},W={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},z={class:"p-6 text-gray-900"},J={class:"grid grid-cols-1 gap-6"},X={key:0,class:"mt-1 text-sm text-red-600"},H={key:0,class:"mt-1 text-sm text-red-600"},Q={class:"grid grid-cols-2 gap-6"},Y={key:0,class:"mt-1 text-sm text-red-600"},Z={key:0,class:"mt-1 text-sm text-red-600"},ee={class:"grid grid-cols-7 gap-2"},te=["id","value"],se=["for"],ae={key:0,class:"mt-1 text-sm text-red-600"},oe={key:0,class:"mt-1 text-sm text-red-600"},re={key:0,class:"mt-1 text-sm text-red-600"},ie={class:"grid grid-cols-2 gap-6"},de={key:0,class:"mt-1 text-sm text-red-600"},ne={key:0,class:"mt-1 text-sm text-red-600"},le={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},ce={class:"space-y-1 text-center"},me={key:0,class:"flex gap-4 mb-4"},ue=["src"],ge=["onClick"],pe={class:"text-sm text-gray-600"},fe={class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},_e={key:0,class:"mt-1 text-sm text-red-600"},ye={class:"mt-6 flex justify-end"},xe=["disabled"],Oe={__name:"Edit",props:{package:Object},setup(U){const l=U,j=S(()=>[{title:"Packages",link:route("packages.index")},{title:"Edit Package"}]),E=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=C({name:l.package.name,description:l.package.description,images:l.package.images||[],display_price_adult:l.package.display_price_adult,display_price_child:l.package.display_price_child,package_min_days:l.package.package_max_days,package_max_days:l.package.package_max_days,terms_and_conditions:l.package.terms_and_conditions,location:l.package.location,package_start_date:l.package.package_start_date,package_end_date:l.package.package_end_date,weekend_days:l.package.weekend_days||[0,6]}),O=r=>{const e=Array.from(r.target.files),o=10*1024*1024,i=["image/jpeg","image/png","image/gif"],u=[];if(e.forEach(f=>{i.includes(f.type)||u.push(`${f.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),f.size>o&&u.push(`${f.name} is too large. Maximum file size is 10MB.`)}),u.length>0){y.fire({title:"Invalid Images",html:u.join("<br>"),icon:"error",confirmButtonText:"OK"});return}t.images=[...t.images,...e]},T=r=>{const e=t.images[r];typeof e=="string"&&(t.delete_images||(t.delete_images=[]),t.delete_images.push(e)),t.images.splice(r,1)},P=r=>typeof r=="string"?V(r):typeof window<"u"&&window.URL&&window.URL.createObjectURL?URL.createObjectURL(r):"",V=r=>r.startsWith("images/")?`/${r}`:r.startsWith("room-types/")?`/images/${r}`:`/images/${r}`;D(()=>{t.images.forEach(r=>{r instanceof File&&URL.revokeObjectURL(URL.createObjectURL(r))})});const $=()=>{const r=new FormData;Object.keys(t).forEach(e=>{e==="images"?t.images.forEach((o,i)=>{o instanceof File?r.append(`images[${i}]`,o):typeof o=="string"&&r.append(`existing_images[${i}]`,o)}):e==="delete_images"?t.delete_images&&t.delete_images.length>0&&t.delete_images.forEach((o,i)=>{r.append(`delete_images[${i}]`,o)}):Array.isArray(t[e])?r.append(e,JSON.stringify(t[e])):r.append(e,t[e])}),N.post(route("packages.update",l.package.id),r,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-HTTP-Method-Override":"PUT"}}).then(e=>{y.fire({title:"Success!",text:"Package has been updated successfully.",icon:"success",confirmButtonText:"OK"}).then(()=>{window.location.href=route("packages.show",l.package.id)})}).catch(e=>{var o,i,u,f;if(console.error("Error updating package:",e),(i=(o=e.response)==null?void 0:o.data)!=null&&i.errors){const L=e.response.data.errors,x=[];Object.entries(L).forEach(([w,k])=>{Array.isArray(k)?x.push(`${w}: ${k.join(", ")}`):x.push(`${w}: ${k}`)}),y.fire({title:"Validation Error",html:x.join("<br>"),icon:"error",confirmButtonText:"OK"})}else y.fire({title:"Error",text:((f=(u=e.response)==null?void 0:u.data)==null?void 0:f.message)||"Failed to update package. Please try again.",icon:"error",confirmButtonText:"OK"})})};return(r,e)=>(n(),d(v,null,[_(a(M),{title:"Edit Package"}),_(A,null,{header:b(()=>e[9]||(e[9]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},null,-1)])),default:b(()=>[s("div",q,[s("div",K,[s("div",W,[s("div",z,[_(G,{breadcrumbs:j.value,class:"mb-9"},null,8,["breadcrumbs"]),s("form",{onSubmit:R($,["prevent"])},[s("div",J,[s("div",null,[e[10]||(e[10]=s("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),g(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[p,a(t).name]]),a(t).errors.name?(n(),d("div",X,m(a(t).errors.name),1)):c("",!0)]),s("div",null,[e[11]||(e[11]=s("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),g(s("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=o=>a(t).description=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a(t).description]]),a(t).errors.description?(n(),d("div",H,m(a(t).errors.description),1)):c("",!0)]),s("div",Q,[s("div",null,[e[12]||(e[12]=s("label",{for:"display_price_adult",class:"block text-sm font-medium text-gray-700"},"Display Price",-1)),g(s("input",{type:"number",id:"display_price_adult","onUpdate:modelValue":e[2]||(e[2]=o=>a(t).display_price_adult=o),step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a(t).display_price_adult]]),a(t).errors.display_price_adult?(n(),d("div",Y,m(a(t).errors.display_price_adult),1)):c("",!0)]),s("div",null,[e[13]||(e[13]=s("label",{for:"package_max_days",class:"block text-sm font-medium text-gray-700"},"Package Duration (Nights)",-1)),g(s("input",{type:"number",id:"package_max_days","onUpdate:modelValue":e[3]||(e[3]=o=>a(t).package_max_days=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[p,a(t).package_max_days]]),a(t).errors.package_max_days?(n(),d("div",Z,m(a(t).errors.package_max_days),1)):c("",!0)]),s("div",null,[e[14]||(e[14]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Weekend Days",-1)),s("div",ee,[(n(),d(v,null,h(E,(o,i)=>s("div",{key:i,class:"flex items-center"},[g(s("input",{type:"checkbox",id:"day-"+i,value:i,"onUpdate:modelValue":e[4]||(e[4]=u=>a(t).weekend_days=u),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,8,te),[[B,a(t).weekend_days,void 0,{number:!0}]]),s("label",{for:"day-"+i,class:"ml-2 text-sm text-gray-700"},m(o),9,se)])),64))]),e[15]||(e[15]=s("p",{class:"mt-1 text-sm text-gray-500"},"Select which days are considered weekends for pricing purposes.",-1)),a(t).errors.weekend_days?(n(),d("div",ae,m(a(t).errors.weekend_days),1)):c("",!0)])]),s("div",null,[e[16]||(e[16]=s("label",{for:"terms_and_conditions",class:"block text-sm font-medium text-gray-700"},"Terms and Conditions",-1)),g(s("textarea",{id:"terms_and_conditions","onUpdate:modelValue":e[5]||(e[5]=o=>a(t).terms_and_conditions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a(t).terms_and_conditions]]),a(t).errors.terms_and_conditions?(n(),d("div",oe,m(a(t).errors.terms_and_conditions),1)):c("",!0)]),s("div",null,[e[17]||(e[17]=s("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Location",-1)),g(s("input",{type:"text",id:"location","onUpdate:modelValue":e[6]||(e[6]=o=>a(t).location=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a(t).location]]),a(t).errors.location?(n(),d("div",re,m(a(t).errors.location),1)):c("",!0)]),s("div",ie,[s("div",null,[e[18]||(e[18]=s("label",{for:"package_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),g(s("input",{type:"date",id:"package_start_date","onUpdate:modelValue":e[7]||(e[7]=o=>a(t).package_start_date=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[p,a(t).package_start_date]]),a(t).errors.package_start_date?(n(),d("div",de,m(a(t).errors.package_start_date),1)):c("",!0)]),s("div",null,[e[19]||(e[19]=s("label",{for:"package_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),g(s("input",{type:"date",id:"package_end_date","onUpdate:modelValue":e[8]||(e[8]=o=>a(t).package_end_date=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a(t).package_end_date]]),a(t).errors.package_end_date?(n(),d("div",ne,m(a(t).errors.package_end_date),1)):c("",!0)])]),s("div",null,[e[23]||(e[23]=s("label",{class:"block text-sm font-medium text-gray-700"},"Package Images",-1)),s("div",le,[s("div",ce,[a(t).images&&a(t).images.length>0?(n(),d("div",me,[(n(!0),d(v,null,h(a(t).images,(o,i)=>(n(),d("div",{key:i,class:"relative group"},[s("img",{src:P(o),class:"h-24 w-full object-cover rounded-lg",alt:"Room type image"},null,8,ue),s("button",{type:"button",onClick:u=>T(i),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition-opacity"},e[20]||(e[20]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ge)]))),128))])):c("",!0),s("div",pe,[s("label",fe,[e[21]||(e[21]=s("span",null,"Upload Images",-1)),s("input",{type:"file",onChange:O,accept:"image/*",multiple:"",class:"sr-only"},null,32)])]),e[22]||(e[22]=s("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 10MB",-1))])]),a(t).errors.images?(n(),d("div",_e,m(a(t).errors.images),1)):c("",!0)])]),s("div",ye,[_(a(F),{href:r.route("packages.index"),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 mr-3 text-xs"},{default:b(()=>e[24]||(e[24]=[I(" Cancel ")])),_:1},8,["href"]),s("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:a(t).processing}," Update Package ",8,xe)])],32)])])])])]),_:1})],64))}};export{Oe as default};
