import{l as b,C as z,i as M,g as s,o as r,b as t,h as k,j as C,x as I,F as a,p as c,a as G,u as x,t as u,e as H,L as R,f as _,k as B}from"./app-BcadWjzC.js";import{S as $}from"./sweetalert2.esm.all-DWO__QVt.js";import{L as J}from"./LoadingComponent-dLFMcSWZ.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"space-y-6"},X={class:"bg-white shadow rounded-lg p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ee=["value"],te=["value"],se={class:"mt-6 flex space-x-2"},re=["disabled"],oe={key:0},ie={key:1},de={key:0,class:"bg-white shadow rounded-lg p-6"},ae={key:0,class:"flex justify-center items-center h-full min-h-[400px]"},le={key:1,class:"text-center py-8 text-gray-500"},ne={key:2,class:"space-y-8"},ue={class:"flex justify-between items-center"},ce={class:"space-x-2"},pe=["disabled"],me={class:"overflow-x-auto"},ye={class:"min-w-full divide-y divide-gray-200"},ge={class:"bg-gray-50"},xe={class:"bg-white divide-y divide-gray-200"},fe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},be={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},_e={key:0,class:"font-medium"},he={key:1,class:"text-gray-400"},ve={key:2,class:"font-medium"},we={key:3,class:"text-gray-400"},ke={key:0,class:"bg-gray-100"},Ce={key:0,class:"overflow-x-auto"},Ae={class:"min-w-full divide-y divide-gray-200"},Pe={class:"bg-gray-50"},Te={class:"bg-white divide-y divide-gray-200"},Se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Be={key:0,class:"font-medium"},Ne={key:1,class:"text-gray-400"},Re={key:2,class:"font-medium"},$e={key:3,class:"text-gray-400"},Ee={key:0,class:"bg-gray-100"},Fe={class:"space-y-8"},Ue={class:"overflow-x-auto"},Me={class:"min-w-full divide-y divide-gray-200"},Ie={class:"bg-gray-50"},Le={class:"bg-white divide-y divide-gray-200"},je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},De={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Oe={key:0,class:"font-medium"},qe=["onUpdate:modelValue"],Ke={key:2,class:"font-medium"},Ye=["onUpdate:modelValue"],ze={key:0,class:"bg-gray-100"},Ge={class:"overflow-x-auto"},He={class:"min-w-full divide-y divide-gray-200"},Je={class:"bg-gray-50"},Qe={class:"bg-white divide-y divide-gray-200"},We={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Xe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ze={key:0,class:"font-medium"},et=["onUpdate:modelValue"],tt={key:2,class:"font-medium"},st=["onUpdate:modelValue"],rt={key:0,class:"bg-gray-100"},ot={__name:"PriceConfigurationRoomTypes",props:{packageId:{type:Number,required:!0},seasonTypes:{type:Array,required:!0},dateTypes:{type:Array,required:!0}},setup(N){const P=N,h=b(""),v=b(""),T=b(!1),S=b(!1),y=b([]),A=b(!1),L=b(!1),m=b(!1),l=z({package_id:P.packageId,season_type_id:"",date_type_id:"",prices:{base_charge:[],sur_charge:[]}}),j=M(()=>h.value&&v.value),D=M(()=>y.value.some(n=>n.prices.some(e=>e.type==="sur_charge"))),E=()=>{A.value=!0,R.post(route("configuration-prices.fetchPricesRoomTypes"),{package_id:P.packageId,season_type_id:h.value,date_type_id:v.value}).then(n=>{n.data&&n.data.length>0?(y.value=n.data,T.value=!0,S.value=!0):(T.value=!0,S.value=!1)}).catch(n=>{console.error("Error fetching prices:",n),$.fire({icon:"error",title:"Error",text:"Failed to fetch price configurations",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})}).finally(()=>{A.value=!1})},V=(n,e,o,i,d)=>{const p=n.prices.find(w=>w.number_of_adults===e&&w.number_of_children===o&&w.type===i);return p?`MYR ${p[d+"_price"]}`:"-"},O=()=>{h.value="",v.value="",T.value=!1,S.value=!1,L.value=!1,m.value=!1,y.value=[],l.reset()},g=(n,e,o)=>(n-1)*4+e,q=n=>{m.value=n==="edit",l.reset(),l.package_id=P.packageId,l.season_type_id=h.value,l.date_type_id=v.value;const e=Array(16).fill().map((o,i)=>({number_of_adults:Math.floor(i/4)+1,number_of_children:i%4,adult_price:"",child_price:""}));l.prices={base_charge:[...e],sur_charge:[...e]},m.value&&y.value.length>0&&y.value[0].prices.forEach(i=>{const d=g(i.number_of_adults,i.number_of_children,i.type),p=i.type==="base_charge"?"base_charge":"sur_charge";l.prices[p][d]={...l.prices[p][d],adult_price:i.adult_price,child_price:i.child_price}})},F=()=>{m.value=!1,l.reset()},U=()=>{const n=y.value.map(e=>{const o={package_id:P.packageId,season_type_id:h.value,date_type_id:v.value,room_type:e.room_type_id,prices:l.prices};return m.value?R.put(route("configuration-prices.updatePrices",e.id),o):R.post(route("configuration-prices.store"),o)});Promise.all(n).then(()=>{F(),E(),$.fire({icon:"success",title:"Success!",text:`Prices ${m.value?"updated":"created"} successfully for all room types`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})}).catch(e=>{var o,i;console.error(`Error ${m.value?"updating":"creating"} prices:`,e),$.fire({icon:"error",title:"Error",text:((i=(o=e.response)==null?void 0:o.data)==null?void 0:i.message)||`Failed to ${m.value?"update":"create"} prices`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})})},K=()=>{if(!l.prices.base_charge||l.prices.base_charge.length===0)return;const n=l.prices.base_charge[0];n&&(l.prices.base_charge=l.prices.base_charge.map((e,o)=>({number_of_adults:Math.floor(o/4)+1,number_of_children:o%4,adult_price:n.adult_price,child_price:n.child_price})))},Y=()=>{if(!l.prices.sur_charge||l.prices.sur_charge.length===0)return;const n=l.prices.sur_charge[0];n&&(l.prices.sur_charge=l.prices.sur_charge.map((e,o)=>({number_of_adults:Math.floor(o/4)+1,number_of_children:o%4,adult_price:n.adult_price,child_price:n.child_price})))},f=(n,e,o,i=!1)=>{const p=[{adults:1,children:0},{adults:1,children:1},{adults:1,children:2},{adults:1,children:3},{adults:2,children:0},{adults:2,children:1},{adults:2,children:2},{adults:3,children:0},{adults:3,children:1},{adults:4,children:0}].some(w=>w.adults===n&&w.children===e);return n==1&&e==0&&i?!0:!(!p||o=="child"&&e==0)};return(n,e)=>(r(),s("div",W,[t("div",X,[t("div",Z,[t("div",null,[e[4]||(e[4]=t("label",{for:"season",class:"block text-sm font-medium text-gray-700"},"Season",-1)),C(t("select",{id:"season","onUpdate:modelValue":e[0]||(e[0]=o=>h.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[3]||(e[3]=t("option",{value:""},"Select Season",-1)),(r(!0),s(a,null,c(N.seasonTypes,o=>(r(),s("option",{key:o.id,value:o.id},u(o.name),9,ee))),128))],512),[[I,h.value]])]),t("div",null,[e[6]||(e[6]=t("label",{for:"dateType",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),C(t("select",{id:"dateType","onUpdate:modelValue":e[1]||(e[1]=o=>v.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[5]||(e[5]=t("option",{value:""},"Select Date Type",-1)),(r(!0),s(a,null,c(N.dateTypes,o=>(r(),s("option",{key:o.id,value:o.id},u(o.name),9,te))),128))],512),[[I,v.value]])])]),t("div",se,[t("button",{onClick:E,disabled:!j.value||A.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs disabled:opacity-50 disabled:cursor-not-allowed"},[A.value?(r(),s("span",oe,"Loading...")):(r(),s("span",ie,"Search Prices"))],8,re),t("button",{onClick:O,class:"px-6 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Reset ")])]),T.value?(r(),s("div",de,[A.value?(r(),s("div",ae,[G(J)])):S.value?(r(),s("div",ne,[t("div",ue,[e[7]||(e[7]=t("h3",{class:"text-lg font-medium text-gray-900"},"Price Matrix for All Room Types",-1)),t("div",ce,[m.value?(r(),s(a,{key:1},[t("button",{onClick:F,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-sm"}," Cancel "),t("button",{onClick:U,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",disabled:x(l).processing},u(m.value?"Update All Prices":"Create Prices"),9,pe)],64)):(r(),s("button",{key:0,onClick:e[2]||(e[2]=o=>q("edit")),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm"}," Edit All Prices "))])]),m.value?(r(),s("form",{key:1,onSubmit:H(U,["prevent"])},[t("div",Fe,[t("div",Ue,[t("div",{class:"flex justify-between items-center mb-4"},[e[18]||(e[18]=t("h3",{class:"text-md font-medium text-gray-900"},"Base Charges",-1)),t("button",{type:"button",onClick:K,class:"px-2 py-1 text-xs font-medium text-yellow-800 bg-yellow-100 hover:bg-yellow-200 rounded-md transition-colors duration-200 border border-yellow-300 hover:border-yellow-400"}," Apply 1st Price To All ")]),t("table",Me,[t("thead",Ie,[t("tr",null,[e[19]||(e[19]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[20]||(e[20]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,o=>t("th",{key:o-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(o-1)+" Children ",1)),64))])]),t("tbody",Le,[(r(!0),s(a,null,c(y.value,o=>(r(),s(a,{key:o.id},[(r(),s(a,null,c(4,i=>(r(),s(a,{key:`${o.id}-${i}`},[t("tr",null,[t("td",je,u(o.room_type.name),1),t("td",De,u(i)+" Adults ",1),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[f(i,d-1,"adult",!0)?(r(),s("div",Oe,[e[21]||(e[21]=_(" Adult: ")),C(t("input",{type:"number","onUpdate:modelValue":p=>x(l).prices.base_charge[g(i,d-1)].adult_price=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Adult Price",step:"0.01"},null,8,qe),[[B,x(l).prices.base_charge[g(i,d-1)].adult_price]])])):(r(),s(a,{key:1},[e[22]||(e[22]=_(" Adult: ")),e[23]||(e[23]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64)),f(i,d-1,"child",!0)?(r(),s("div",Ke,[e[24]||(e[24]=_(" Child: ")),C(t("input",{type:"number","onUpdate:modelValue":p=>x(l).prices.base_charge[g(i,d-1)].child_price=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Child Price",step:"0.01"},null,8,Ye),[[B,x(l).prices.base_charge[g(i,d-1)].child_price]])])):(r(),s(a,{key:3},[e[25]||(e[25]=_(" Child: ")),e[26]||(e[26]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64))])),64))]),i==4?(r(),s("tr",ze,[e[27]||(e[27]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[28]||(e[28]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(d-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])]),t("div",Ge,[t("div",{class:"flex justify-between items-center mb-4"},[e[29]||(e[29]=t("h3",{class:"text-md font-medium text-gray-900"},"Surcharges",-1)),t("button",{type:"button",onClick:Y,class:"px-2 py-1 text-xs font-medium text-yellow-800 bg-yellow-100 hover:bg-yellow-200 rounded-md transition-colors duration-200 border border-yellow-300 hover:border-yellow-400"}," Apply 1st Price To All ")]),t("table",He,[t("thead",Je,[t("tr",null,[e[30]||(e[30]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[31]||(e[31]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,o=>t("th",{key:o-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(o-1)+" Children ",1)),64))])]),t("tbody",Qe,[(r(!0),s(a,null,c(y.value,o=>(r(),s(a,{key:o.id},[(r(),s(a,null,c(4,i=>(r(),s(a,{key:`${o.id}-${i}`},[t("tr",null,[t("td",We,u(o.room_type.name),1),t("td",Xe,u(i)+" Adults ",1),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[f(i,d-1,"adult",!0)?(r(),s("div",Ze,[e[32]||(e[32]=_(" Adult: ")),C(t("input",{type:"number","onUpdate:modelValue":p=>x(l).prices.sur_charge[g(i,d-1)].adult_price=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Adult Price",step:"0.01"},null,8,et),[[B,x(l).prices.sur_charge[g(i,d-1)].adult_price]])])):(r(),s(a,{key:1},[e[33]||(e[33]=_(" Adult: ")),e[34]||(e[34]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64)),f(i,d-1,"child",!0)?(r(),s("div",tt,[e[35]||(e[35]=_(" Child: ")),C(t("input",{type:"number","onUpdate:modelValue":p=>x(l).prices.sur_charge[g(i,d-1)].child_price=p,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Child Price",step:"0.01"},null,8,st),[[B,x(l).prices.sur_charge[g(i,d-1)].child_price]])])):(r(),s(a,{key:3},[e[36]||(e[36]=_(" Child: ")),e[37]||(e[37]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64))])),64))]),i==4?(r(),s("tr",rt,[e[38]||(e[38]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[39]||(e[39]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(d-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])])])],32)):(r(),s(a,{key:0},[t("div",me,[e[12]||(e[12]=t("h4",{class:"text-md font-medium text-gray-700 mb-2"},"Base Charge",-1)),t("table",ye,[t("thead",ge,[t("tr",null,[e[8]||(e[8]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[9]||(e[9]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,o=>t("th",{key:o-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(o-1)+" Children ",1)),64))])]),t("tbody",xe,[(r(!0),s(a,null,c(y.value,o=>(r(),s(a,{key:o.id},[(r(),s(a,null,c(4,i=>(r(),s(a,{key:`${o.id}-${i}`},[t("tr",null,[t("td",fe,u(o.room_type.name),1),t("td",be,u(i)+" Adults ",1),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center"},[f(i,d-1,"adult")?(r(),s("div",_e,"Adult: "+u(V(o,i,d-1,"base_charge","adult")),1)):(r(),s("div",he,"Adult: -")),f(i,d-1,"child")?(r(),s("div",ve,"Child: "+u(V(o,i,d-1,"base_charge","child")),1)):(r(),s("div",we,"Child: -"))])),64))]),i==4?(r(),s("tr",ke,[e[10]||(e[10]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[11]||(e[11]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(d-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])]),D.value?(r(),s("div",Ce,[e[17]||(e[17]=t("h4",{class:"text-md font-medium text-gray-700 mb-2"},"Surcharge",-1)),t("table",Ae,[t("thead",Pe,[t("tr",null,[e[13]||(e[13]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[14]||(e[14]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,o=>t("th",{key:o-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(o-1)+" Children ",1)),64))])]),t("tbody",Te,[(r(!0),s(a,null,c(y.value,o=>(r(),s(a,{key:o.id},[(r(),s(a,null,c(4,i=>(r(),s(a,{key:`${o.id}-${i}`},[t("tr",null,[t("td",Se,u(o.room_type.name),1),t("td",Ve,u(i)+" Adults ",1),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center"},[f(i,d-1,"adult")?(r(),s("div",Be,"Adult: "+u(V(o,i,d-1,"sur_charge","adult")),1)):(r(),s("div",Ne,"Adult: -")),f(i,d-1,"child")?(r(),s("div",Re,"Child: "+u(V(o,i,d-1,"sur_charge","child")),1)):(r(),s("div",$e,"Child: -"))])),64))]),i==4?(r(),s("tr",Ee,[e[15]||(e[15]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[16]||(e[16]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(r(),s(a,null,c(4,d=>t("td",{key:d-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},u(d-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])])):k("",!0)],64))])):(r(),s("div",le," No price configurations found for the selected filters. "))])):k("",!0)]))}},nt=Q(ot,[["__scopeId","data-v-b8fdc811"]]);export{nt as default};
