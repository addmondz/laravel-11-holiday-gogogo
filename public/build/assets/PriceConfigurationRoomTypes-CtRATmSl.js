import{l as b,C as z,i as U,g as r,o,b as t,h as k,j as C,x as M,F as a,p as c,a as G,u as f,t as p,e as H,L as E,f as h,k as V}from"./app-CN1jGWpK.js";import{S as N}from"./sweetalert2.esm.all-B0Dix5B2.js";import{L as J}from"./LoadingComponent-BsoRKB3Y.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"space-y-6"},X={class:"bg-white shadow rounded-lg p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ee=["value"],te=["value"],se={class:"mt-6 flex space-x-2"},re=["disabled"],oe={key:0},ie={key:1},de={key:0,class:"bg-white shadow rounded-lg p-6"},ae={key:0,class:"flex justify-center items-center h-full min-h-[400px]"},le={key:1,class:"text-center py-8 text-gray-500"},ne={key:2,class:"space-y-8"},ue={class:"flex justify-between items-center"},pe={class:"space-x-2"},ce=["disabled"],ye={class:"overflow-x-auto"},me={class:"min-w-full divide-y divide-gray-200"},xe={class:"bg-gray-50"},ge={class:"bg-white divide-y divide-gray-200"},fe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},_e={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},be={key:0,class:"font-medium"},he={key:1,class:"text-gray-400"},ve={key:2,class:"font-medium"},we={key:3,class:"text-gray-400"},ke={key:0,class:"bg-gray-100"},Ce={key:0,class:"overflow-x-auto"},Te={class:"min-w-full divide-y divide-gray-200"},Ae={class:"bg-gray-50"},Pe={class:"bg-white divide-y divide-gray-200"},Se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Re={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ve={key:0,class:"font-medium"},Be={key:1,class:"text-gray-400"},Ee={key:2,class:"font-medium"},Ne={key:3,class:"text-gray-400"},$e={key:0,class:"bg-gray-100"},Ie={class:"space-y-8"},Fe={class:"overflow-x-auto"},Ue={class:"min-w-full divide-y divide-gray-200"},Me={class:"bg-gray-50"},Le={class:"bg-white divide-y divide-gray-200"},je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},De={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Oe={key:0,class:"font-medium"},qe=["onUpdate:modelValue"],Ke={key:2,class:"font-medium"},Ye=["onUpdate:modelValue"],ze={key:0,class:"bg-gray-100"},Ge={class:"overflow-x-auto"},He={class:"min-w-full divide-y divide-gray-200"},Je={class:"bg-gray-50"},Qe={class:"bg-white divide-y divide-gray-200"},We={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Xe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ze={key:0,class:"font-medium"},et=["onUpdate:modelValue"],tt={key:2,class:"font-medium"},st=["onUpdate:modelValue"],rt={key:0,class:"bg-gray-100"},ot={__name:"PriceConfigurationRoomTypes",props:{packageId:{type:Number,required:!0},seasonTypes:{type:Array,required:!0},dateTypes:{type:Array,required:!0}},setup(B){const A=B,v=b(""),w=b(""),P=b(!1),S=b(!1),y=b([]),T=b(!1),L=b(!1),m=b(!1),l=z({package_id:A.packageId,season_type_id:"",date_type_id:"",prices:{}}),j=U(()=>v.value&&w.value),D=U(()=>y.value.some(u=>u.prices.some(e=>e.type==="sur_charge"))),$=()=>{T.value=!0,E.post(route("configuration-prices.fetchPricesRoomTypes"),{package_id:A.packageId,season_type_id:v.value,date_type_id:w.value}).then(u=>{u.data&&u.data.length>0?(y.value=u.data,P.value=!0,S.value=!0):(P.value=!0,S.value=!1)}).catch(u=>{console.error("Error fetching prices:",u),N.fire({icon:"error",title:"Error",text:"Failed to fetch price configurations",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})}).finally(()=>{T.value=!1})},R=(u,e,s,d,i)=>{const n=u.prices.find(g=>g.number_of_adults===e&&g.number_of_children===s&&g.type===d);return n?`MYR ${n[i+"_price"]}`:"-"},O=()=>{v.value="",w.value="",P.value=!1,S.value=!1,L.value=!1,m.value=!1,y.value=[],l.reset()},x=(u,e,s)=>(u-1)*4+e,q=u=>{m.value=u==="edit",l.reset(),l.package_id=A.packageId,l.season_type_id=v.value,l.date_type_id=w.value,y.value.forEach(e=>{const s=e.room_type_id,d=Array(16).fill().map((i,n)=>({number_of_adults:Math.floor(n/4)+1,number_of_children:n%4,adult_price:"",child_price:""}));l.prices[s]={base_charge:[...d],sur_charge:[...d]},m.value&&e.prices.forEach(i=>{const n=x(i.number_of_adults,i.number_of_children,i.type),g=i.type==="base_charge"?"base_charge":"sur_charge";l.prices[s][g][n]={...l.prices[s][g][n],adult_price:i.adult_price,child_price:i.child_price}})})},I=()=>{m.value=!1,l.reset()},F=()=>{const u=y.value.map(e=>{const s={package_id:A.packageId,season_type_id:v.value,date_type_id:w.value,prices:l.prices};return m.value?E.put(route("configuration-prices.updateRoomTypePrices",e.id),s):E.post(route("configuration-prices.store"),s)});Promise.all(u).then(()=>{I(),$(),N.fire({icon:"success",title:"Success!",text:`Prices ${m.value?"updated":"created"} successfully for all room types`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})}).catch(e=>{var s,d;console.error(`Error ${m.value?"updating":"creating"} prices:`,e),N.fire({icon:"error",title:"Error",text:((d=(s=e.response)==null?void 0:s.data)==null?void 0:d.message)||`Failed to ${m.value?"update":"create"} prices`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"})})},K=()=>{if(!y.value.length)return;const u=y.value[0].room_type_id,e=l.prices[u].base_charge[0];e&&y.value.forEach(s=>{const d=s.room_type_id;l.prices[d].base_charge=l.prices[d].base_charge.map((i,n)=>({number_of_adults:Math.floor(n/4)+1,number_of_children:n%4,adult_price:e.adult_price,child_price:e.child_price}))})},Y=()=>{if(!y.value.length)return;const u=y.value[0].room_type_id,e=l.prices[u].sur_charge[0];e&&y.value.forEach(s=>{const d=s.room_type_id;l.prices[d].sur_charge=l.prices[d].sur_charge.map((i,n)=>({number_of_adults:Math.floor(n/4)+1,number_of_children:n%4,adult_price:e.adult_price,child_price:e.child_price}))})},_=(u,e,s,d=!1)=>{const n=[{adults:1,children:0},{adults:1,children:1},{adults:1,children:2},{adults:1,children:3},{adults:2,children:0},{adults:2,children:1},{adults:2,children:2},{adults:3,children:0},{adults:3,children:1},{adults:4,children:0}].some(g=>g.adults===u&&g.children===e);return u==1&&e==0&&d?!0:!(!n||s=="child"&&e==0)};return(u,e)=>(o(),r("div",W,[t("div",X,[t("div",Z,[t("div",null,[e[4]||(e[4]=t("label",{for:"season",class:"block text-sm font-medium text-gray-700"},"Season",-1)),C(t("select",{id:"season","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[3]||(e[3]=t("option",{value:""},"Select Season",-1)),(o(!0),r(a,null,c(B.seasonTypes,s=>(o(),r("option",{key:s.id,value:s.id},p(s.name),9,ee))),128))],512),[[M,v.value]])]),t("div",null,[e[6]||(e[6]=t("label",{for:"dateType",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),C(t("select",{id:"dateType","onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[5]||(e[5]=t("option",{value:""},"Select Date Type",-1)),(o(!0),r(a,null,c(B.dateTypes,s=>(o(),r("option",{key:s.id,value:s.id},p(s.name),9,te))),128))],512),[[M,w.value]])])]),t("div",se,[t("button",{onClick:$,disabled:!j.value||T.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs disabled:opacity-50 disabled:cursor-not-allowed"},[T.value?(o(),r("span",oe,"Loading...")):(o(),r("span",ie,"Search Prices"))],8,re),t("button",{onClick:O,class:"px-6 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Reset ")])]),P.value?(o(),r("div",de,[T.value?(o(),r("div",ae,[G(J)])):S.value?(o(),r("div",ne,[t("div",ue,[e[7]||(e[7]=t("h3",{class:"text-lg font-medium text-gray-900"},"Price Matrix for All Room Types",-1)),t("div",pe,[m.value?(o(),r(a,{key:1},[t("button",{onClick:I,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-sm"}," Cancel "),t("button",{onClick:F,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",disabled:f(l).processing},p(m.value?"Update All Prices":"Create Prices"),9,ce)],64)):(o(),r("button",{key:0,onClick:e[2]||(e[2]=s=>q("edit")),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm"}," Edit All Prices "))])]),m.value?(o(),r("form",{key:1,onSubmit:H(F,["prevent"])},[t("div",Ie,[t("div",Fe,[t("div",{class:"flex justify-between items-center mb-4"},[e[18]||(e[18]=t("h3",{class:"text-lg font-bold text-gray-900"},"Base Charges",-1)),t("button",{type:"button",onClick:K,class:"px-2 py-1 text-xs font-medium text-yellow-800 bg-yellow-100 hover:bg-yellow-200 rounded-md transition-colors duration-200 border border-yellow-300 hover:border-yellow-400"}," Apply 1st Price To All ")]),t("table",Ue,[t("thead",Me,[t("tr",null,[e[19]||(e[19]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[20]||(e[20]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,s=>t("th",{key:s-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(s-1)+" Children ",1)),64))])]),t("tbody",Le,[(o(!0),r(a,null,c(y.value,s=>(o(),r(a,{key:s.id},[(o(),r(a,null,c(4,d=>(o(),r(a,{key:`${s.id}-${d}`},[t("tr",null,[t("td",je,p(s.room_type.name),1),t("td",De,p(d)+" Adults ",1),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[_(d,i-1,"adult",!0)?(o(),r("div",Oe,[e[21]||(e[21]=h(" Adult: ")),C(t("input",{type:"number","onUpdate:modelValue":n=>f(l).prices[s.room_type_id].base_charge[x(d,i-1)].adult_price=n,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Adult Price",step:"0.01"},null,8,qe),[[V,f(l).prices[s.room_type_id].base_charge[x(d,i-1)].adult_price]])])):(o(),r(a,{key:1},[e[22]||(e[22]=h(" Adult: ")),e[23]||(e[23]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64)),_(d,i-1,"child",!0)?(o(),r("div",Ke,[e[24]||(e[24]=h(" Child: ")),C(t("input",{type:"number","onUpdate:modelValue":n=>f(l).prices[s.room_type_id].base_charge[x(d,i-1)].child_price=n,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Child Price",step:"0.01"},null,8,Ye),[[V,f(l).prices[s.room_type_id].base_charge[x(d,i-1)].child_price]])])):(o(),r(a,{key:3},[e[25]||(e[25]=h(" Child: ")),e[26]||(e[26]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64))])),64))]),d==4?(o(),r("tr",ze,[e[27]||(e[27]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[28]||(e[28]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(i-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])]),t("div",Ge,[t("div",{class:"flex justify-between items-center mb-4"},[e[29]||(e[29]=t("h3",{class:"text-lg font-bold text-gray-900"},"Surcharges",-1)),t("button",{type:"button",onClick:Y,class:"px-2 py-1 text-xs font-medium text-yellow-800 bg-yellow-100 hover:bg-yellow-200 rounded-md transition-colors duration-200 border border-yellow-300 hover:border-yellow-400"}," Apply 1st Price To All ")]),t("table",He,[t("thead",Je,[t("tr",null,[e[30]||(e[30]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[31]||(e[31]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,s=>t("th",{key:s-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(s-1)+" Children ",1)),64))])]),t("tbody",Qe,[(o(!0),r(a,null,c(y.value,s=>(o(),r(a,{key:s.id},[(o(),r(a,null,c(4,d=>(o(),r(a,{key:`${s.id}-${d}`},[t("tr",null,[t("td",We,p(s.room_type.name),1),t("td",Xe,p(d)+" Adults ",1),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[_(d,i-1,"adult",!0)?(o(),r("div",Ze,[e[32]||(e[32]=h(" Adult: ")),C(t("input",{type:"number","onUpdate:modelValue":n=>f(l).prices[s.room_type_id].sur_charge[x(d,i-1)].adult_price=n,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Adult Price",step:"0.01"},null,8,et),[[V,f(l).prices[s.room_type_id].sur_charge[x(d,i-1)].adult_price]])])):(o(),r(a,{key:1},[e[33]||(e[33]=h(" Adult: ")),e[34]||(e[34]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64)),_(d,i-1,"child",!0)?(o(),r("div",tt,[e[35]||(e[35]=h(" Child: ")),C(t("input",{type:"number","onUpdate:modelValue":n=>f(l).prices[s.room_type_id].sur_charge[x(d,i-1)].child_price=n,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm mb-4",placeholder:"Child Price",step:"0.01"},null,8,st),[[V,f(l).prices[s.room_type_id].sur_charge[x(d,i-1)].child_price]])])):(o(),r(a,{key:3},[e[36]||(e[36]=h(" Child: ")),e[37]||(e[37]=t("span",{class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 border border-solid bg-gray-100 mb-4"},"-",-1))],64))])),64))]),d==4?(o(),r("tr",rt,[e[38]||(e[38]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[39]||(e[39]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(i-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])])])],32)):(o(),r(a,{key:0},[t("div",ye,[e[12]||(e[12]=t("h4",{class:"text-lg font-bold text-gray-700 mb-2"},"Base Charge",-1)),t("table",me,[t("thead",xe,[t("tr",null,[e[8]||(e[8]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[9]||(e[9]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,s=>t("th",{key:s-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(s-1)+" Children ",1)),64))])]),t("tbody",ge,[(o(!0),r(a,null,c(y.value,s=>(o(),r(a,{key:s.id},[(o(),r(a,null,c(4,d=>(o(),r(a,{key:`${s.id}-${d}`},[t("tr",null,[t("td",fe,p(s.room_type.name),1),t("td",_e,p(d)+" Adults ",1),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center"},[_(d,i-1,"adult")?(o(),r("div",be,"Adult: "+p(R(s,d,i-1,"base_charge","adult")),1)):(o(),r("div",he,"Adult: -")),_(d,i-1,"child")?(o(),r("div",ve,"Child: "+p(R(s,d,i-1,"base_charge","child")),1)):(o(),r("div",we,"Child: -"))])),64))]),d==4?(o(),r("tr",ke,[e[10]||(e[10]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[11]||(e[11]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(i-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])]),D.value?(o(),r("div",Ce,[e[17]||(e[17]=t("h4",{class:"text-lg font-bold text-gray-700 mb-2"},"Surcharge",-1)),t("table",Te,[t("thead",Ae,[t("tr",null,[e[13]||(e[13]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[14]||(e[14]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,s=>t("th",{key:s-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(s-1)+" Children ",1)),64))])]),t("tbody",Pe,[(o(!0),r(a,null,c(y.value,s=>(o(),r(a,{key:s.id},[(o(),r(a,null,c(4,d=>(o(),r(a,{key:`${s.id}-${d}`},[t("tr",null,[t("td",Se,p(s.room_type.name),1),t("td",Re,p(d)+" Adults ",1),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center"},[_(d,i-1,"adult")?(o(),r("div",Ve,"Adult: "+p(R(s,d,i-1,"sur_charge","adult")),1)):(o(),r("div",Be,"Adult: -")),_(d,i-1,"child")?(o(),r("div",Ee,"Child: "+p(R(s,d,i-1,"sur_charge","child")),1)):(o(),r("div",Ne,"Child: -"))])),64))]),d==4?(o(),r("tr",$e,[e[15]||(e[15]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type",-1)),e[16]||(e[16]=t("td",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No. of Adults",-1)),(o(),r(a,null,c(4,i=>t("td",{key:i-1,class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},p(i-1)+" Children ",1)),64))])):k("",!0)],64))),64))],64))),128))])])])):k("",!0)],64))])):(o(),r("div",le," No price configurations found for the selected filters. "))])):k("",!0)]))}},nt=Q(ot,[["__scopeId","data-v-a93e798e"]]);export{nt as default};
