import{l as m,i as W,C as q,M as B,g as u,o as l,b as t,a as M,h,F as C,p as S,c as K,w as R,t as g,e as V,j as f,u as o,q as F,k as b,x as I,W as P}from"./app-BFBr3gDz.js";import{_ as U}from"./Modal.vue_vue_type_script_setup_true_lang-EAHWiodm.js";import{P as L}from"./Pagination-DbOjxaV_.js";import{S as k}from"./sweetalert2.esm.all-B0Dix5B2.js";import{h as _}from"./moment-C5S46NFB.js";import"./LoadingComponent-YScQFL9D.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"space-y-6"},G={class:"flex justify-between items-center"},H={class:"overflow-x-auto"},J={class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-white divide-y divide-gray-200"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},te={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ae=["onClick"],de=["onClick"],se={key:0},oe={class:"mt-4"},re={class:"p-6"},ie={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ne={class:"space-y-4"},le=["value"],ue={class:"mt-6 flex justify-end space-x-3"},pe=["disabled"],ge={class:"p-6"},ce={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ye={class:"space-y-4"},me=["value"],fe={class:"mt-6 flex justify-end space-x-3"},_e=["disabled"],Ce={__name:"DateTypesRanges",props:{package:{type:Object,required:!0},dateTypeRanges:{type:Object,required:!0},dateTypes:{type:Array,required:!0}},setup(w){const c=w,T=m(0),p=m(c.dateTypeRanges),y=m(!1),v=m(!1),i=m(""),n=m(""),x=W(()=>({links:p.value.links,from:p.value.from,to:p.value.to,total:p.value.total})),r=q({date_type_id:"",start_date:"",end_date:"",package_id:c.package.id,return_to_package:!0}),s=q({id:null,date_type_id:"",start_date:"",end_date:"",package_id:c.package.id,return_to_package:!0});B(y,a=>{a||(i.value="")}),B(v,a=>{a||(n.value="")});const D=async a=>{try{const e=await I.get(route("packages.date-type-ranges",c.package.id),{params:{page:a}});p.value={...p.value,data:e.data.data,links:e.data.links,from:e.data.from,to:e.data.to,total:e.data.total,current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page},T.value++}catch(e){console.error("Error fetching date type ranges:",e)}},j=()=>{if(!r.date_type_id){i.value="Date type is required";return}if(!r.start_date){i.value="Start date is required";return}if(!r.end_date){i.value="End date is required";return}if(_(r.end_date).isBefore(r.start_date)){i.value="End date must be after start date";return}r.post(route("date-type-ranges.store"),{preserveScroll:!0,onSuccess:()=>{y.value=!1,r.reset(),k.fire({icon:"success",title:"Success",text:"Date type range created successfully"}),P.get(route("packages.show",c.package.id))},onError:a=>{a.date_type_id?i.value=a.date_type_id:a.start_date?i.value=a.start_date:a.end_date?i.value=a.end_date:a.package_id?i.value=a.package_id:i.value="Failed to create date type range. Please try again."}})},A=a=>{s.reset(),s.id=a.id,s.date_type_id=a.date_type_id,s.start_date=_(a.start_date).format("YYYY-MM-DD"),s.end_date=_(a.end_date).format("YYYY-MM-DD"),s.package_id=parseInt(c.package.id),s.return_to_package=!0,v.value=!0},Y=()=>{v.value=!1,s.reset(),n.value=""},N=()=>{if(!s.date_type_id){n.value="Date type is required";return}if(!s.start_date){n.value="Start date is required";return}if(!s.end_date){n.value="End date is required";return}if(_(s.end_date).isBefore(s.start_date)){n.value="End date must be after start date";return}s.put(route("date-type-ranges.update",s.id),{preserveScroll:!0,onSuccess:()=>{v.value=!1,s.reset(),k.fire({icon:"success",title:"Success",text:"Date type range updated successfully"}),D(1)},onError:a=>{a.date_type_id?n.value=a.date_type_id:a.start_date?n.value=a.start_date:a.end_date?n.value=a.end_date:a.package_id?n.value=a.package_id:n.value="Failed to update date type range. Please try again."}})},$=a=>{k.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",showConfirmButton:!0,showCloseButton:!0}).then(e=>{e.isConfirmed&&P.delete(route("date-type-ranges.destroy",a),{data:{return_to_package:!0},preserveState:!0,preserveScroll:!0,onSuccess:()=>{k.fire({title:"Deleted!",text:"Date type range has been deleted.",icon:"success",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),D(1)}})})};return(a,e)=>(l(),u("div",z,[t("div",G,[e[9]||(e[9]=t("h3",{class:"text-md font-medium text-gray-900"},"Date Types Ranges",-1)),t("button",{onClick:e[0]||(e[0]=d=>y.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Date Type Range ")]),t("div",H,[t("table",J,[e[11]||(e[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Start Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"End Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",Q,[(l(!0),u(C,null,S(p.value.data,d=>{var E;return l(),u("tr",{key:d.id},[t("td",X,g((E=d.date_type)==null?void 0:E.name),1),t("td",Z,g(o(_)(d.start_date).format("DD/MM/YYYY")),1),t("td",ee,g(o(_)(d.end_date).format("DD/MM/YYYY")),1),t("td",te,[t("button",{onClick:O=>A(d),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,ae),t("button",{onClick:O=>$(d.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,de)])])}),128)),p.value.data.length===0?(l(),u("tr",se,e[10]||(e[10]=[t("td",{colspan:"4",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"},"No date type ranges found",-1)]))):h("",!0)])])]),t("div",oe,[(l(),K(L,{links:x.value.links,from:x.value.from,to:x.value.to,total:x.value.total,"component-loading":!0,onPageChange:D,key:T.value},null,8,["links","from","to","total"]))]),M(U,{show:y.value,onClose:e[5]||(e[5]=()=>{y.value=!1,o(r).reset(),i.value.value=""})},{default:R(()=>[t("div",re,[e[16]||(e[16]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Date Type Range",-1)),i.value?(l(),u("div",ie,g(i.value),1)):h("",!0),t("form",{onSubmit:V(j,["prevent"])},[t("div",ne,[t("div",null,[e[13]||(e[13]=t("label",{for:"date_type_id",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),f(t("select",{id:"date_type_id","onUpdate:modelValue":e[1]||(e[1]=d=>o(r).date_type_id=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[e[12]||(e[12]=t("option",{value:""},"Select a date type",-1)),(l(!0),u(C,null,S(w.dateTypes,d=>(l(),u("option",{key:d.id,value:d.id},g(d.name),9,le))),128))],512),[[F,o(r).date_type_id]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),f(t("input",{type:"date",id:"start_date","onUpdate:modelValue":e[2]||(e[2]=d=>o(r).start_date=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[b,o(r).start_date]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),f(t("input",{type:"date",id:"end_date","onUpdate:modelValue":e[3]||(e[3]=d=>o(r).end_date=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[b,o(r).end_date]])])]),t("div",ue,[t("button",{type:"button",onClick:e[4]||(e[4]=()=>{y.value=!1,o(r).reset(),i.value.value=""}),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:o(r).processing}," Create Date Type Range ",8,pe)])],32)])]),_:1},8,["show"]),M(U,{show:v.value,onClose:Y},{default:R(()=>[t("div",ge,[e[21]||(e[21]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Date Type Range",-1)),n.value?(l(),u("div",ce,g(n.value),1)):h("",!0),t("form",{onSubmit:V(N,["prevent"])},[t("div",ye,[t("div",null,[e[18]||(e[18]=t("label",{for:"edit_date_type_id",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),f(t("select",{id:"edit_date_type_id","onUpdate:modelValue":e[6]||(e[6]=d=>o(s).date_type_id=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[e[17]||(e[17]=t("option",{value:""},"Select a date type",-1)),(l(!0),u(C,null,S(w.dateTypes,d=>(l(),u("option",{key:d.id,value:d.id},g(d.name),9,me))),128))],512),[[F,o(s).date_type_id]])]),t("div",null,[e[19]||(e[19]=t("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),f(t("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":e[7]||(e[7]=d=>o(s).start_date=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[b,o(s).start_date]])]),t("div",null,[e[20]||(e[20]=t("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),f(t("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":e[8]||(e[8]=d=>o(s).end_date=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[b,o(s).end_date]])])]),t("div",fe,[t("button",{type:"button",onClick:Y,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:o(s).processing}," Update Date Type Range ",8,_e)])],32)])]),_:1},8,["show"])]))}};export{Ce as default};
