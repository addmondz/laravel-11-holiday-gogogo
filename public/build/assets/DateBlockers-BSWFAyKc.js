import{l as f,C as M,q as O,g as c,o as l,b as e,a as S,h as p,F as T,p as z,c as K,w as F,e as A,j as x,n as _,u as r,k as y,t as m,L as V}from"./app-BlUee9Xp.js";import{_ as q}from"./Modal.vue_vue_type_script_setup_true_lang-CsJtneZ7.js";import{P as G}from"./Pagination-CBe83KMP.js";import{h as b}from"./moment-C5S46NFB.js";import{S as i}from"./sweetalert2.esm.all-DWO__QVt.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LoadingComponent-rFYPDVlu.js";const J={class:"space-y-6"},Q={class:"flex justify-between items-center"},R={class:"overflow-x-auto"},W={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},te={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},re=["onClick"],oe=["onClick"],se={key:0},ae={class:"mt-4"},de={class:"p-6"},ne={class:"grid grid-cols-1 gap-6"},le={key:0,class:"mt-1 text-sm text-red-600"},ie={key:0,class:"mt-1 text-sm text-red-600"},ce={class:"mt-6 flex justify-end space-x-3"},ue=["disabled"],me={class:"p-6"},pe={class:"grid grid-cols-1 gap-6"},ge={key:0,class:"mt-1 text-sm text-red-600"},fe={key:0,class:"mt-1 text-sm text-red-600"},xe={class:"mt-6 flex justify-end space-x-3"},_e=["disabled"],ye={__name:"DateBlockers",props:{packageId:{type:Number,required:!0}},setup(N){const B=N,n=f({data:[],links:[],from:null,to:null,total:0,current_page:1,last_page:1,per_page:10}),D=f(0),v=f(!1),k=f(!1),d=M({package_id:B.packageId,start_date:"",end_date:""}),s=M({id:null,start_date:"",end_date:""}),u=async(o=1)=>{try{const t=await V.get(route("date-blockers.index"),{params:{package_id:B.packageId,page:o}});n.value=t.data}catch(t){console.error("Error fetching date blockers:",t)}},U=async o=>{try{await u(o),D.value++}catch(t){console.error("Error changing page:",t)}},j=()=>{d.post(route("date-blockers.store"),{preserveScroll:!0,onSuccess:()=>{h(),u(n.value.current_page),i.fire({title:"Success!",text:d.recentlySuccessful?"Date blocker added successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.date_range?i.fire({title:"Error!",text:o.date_range,icon:"error",confirmButtonColor:"#4F46E5"}):o.error&&i.fire({title:"Error!",text:o.error,icon:"error",confirmButtonColor:"#4F46E5"})}})},I=()=>{s.put(route("date-blockers.update",s.id),{preserveScroll:!0,onSuccess:()=>{w(),u(n.value.current_page),i.fire({title:"Success!",text:s.recentlySuccessful?"Date blocker updated successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.date_range?i.fire({title:"Error!",text:o.date_range,icon:"error",confirmButtonColor:"#4F46E5"}):o.error&&i.fire({title:"Error!",text:o.error,icon:"error",confirmButtonColor:"#4F46E5"})}})},P=async o=>{var a,g,E,C;if((await i.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4F46E5",cancelButtonColor:"#EF4444",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await V.delete(route("date-blockers.destroy",o)),n.value.data.length===1&&n.value.current_page>1?await u(n.value.current_page-1):await u(n.value.current_page),i.fire({title:"Deleted!",text:"Date blocker has been deleted.",icon:"success",confirmButtonColor:"#4F46E5"})}catch(Y){const L=((g=(a=Y.response)==null?void 0:a.data)==null?void 0:g.message)||((C=(E=Y.response)==null?void 0:E.data)==null?void 0:C.error)||"Error deleting date blocker";i.fire({title:"Error!",text:L,icon:"error",confirmButtonColor:"#4F46E5"})}},$=o=>{s.id=o.id,s.start_date=b(o.start_date).format("YYYY-MM-DD"),s.end_date=b(o.end_date).format("YYYY-MM-DD"),k.value=!0},h=()=>{v.value=!1,d.reset(),d.clearErrors()},w=()=>{k.value=!1,s.reset(),s.clearErrors()};return O(()=>{u()}),(o,t)=>(l(),c("div",J,[e("div",Q,[t[5]||(t[5]=e("h3",{class:"text-md font-medium text-gray-900"},"Date Blockers",-1)),e("button",{onClick:t[0]||(t[0]=a=>v.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Date Blocker ")]),e("div",R,[e("table",W,[t[7]||(t[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," End Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",X,[(l(!0),c(T,null,z(n.value.data,a=>(l(),c("tr",{key:a.id},[e("td",Z,m(r(b)(a.start_date).format("DD/MM/YYYY")),1),e("td",ee,m(r(b)(a.end_date).format("DD/MM/YYYY")),1),e("td",te,[e("button",{onClick:g=>$(a),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,re),e("button",{onClick:g=>P(a.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,oe)])]))),128)),n.value.data.length===0?(l(),c("tr",se,t[6]||(t[6]=[e("td",{colspan:"3",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"}," No date blockers found ",-1)]))):p("",!0)])])]),e("div",ae,[(l(),K(G,{links:n.value.links,from:n.value.from,to:n.value.to,total:n.value.total,"component-loading":!0,onPageChange:U,key:D.value},null,8,["links","from","to","total"]))]),S(q,{show:v.value,onClose:h},{default:F(()=>[e("div",de,[t[10]||(t[10]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Date Blocker",-1)),e("form",{onSubmit:A(j,["prevent"])},[e("div",ne,[e("div",null,[t[8]||(t[8]=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"start_date","onUpdate:modelValue":t[1]||(t[1]=a=>r(d).start_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.start_date}]),required:""},null,2),[[y,r(d).start_date]]),r(d).errors.start_date?(l(),c("div",le,m(r(d).errors.start_date),1)):p("",!0)]),e("div",null,[t[9]||(t[9]=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"end_date","onUpdate:modelValue":t[2]||(t[2]=a=>r(d).end_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.end_date}]),required:""},null,2),[[y,r(d).end_date]]),r(d).errors.end_date?(l(),c("div",ie,m(r(d).errors.end_date),1)):p("",!0)])]),e("div",ce,[e("button",{type:"button",onClick:h,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(d).processing}," Add Date Blocker ",8,ue)])],32)])]),_:1},8,["show"]),S(q,{show:k.value,onClose:w},{default:F(()=>[e("div",me,[t[13]||(t[13]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Date Blocker",-1)),e("form",{onSubmit:A(I,["prevent"])},[e("div",pe,[e("div",null,[t[11]||(t[11]=e("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":t[3]||(t[3]=a=>r(s).start_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.start_date}]),required:""},null,2),[[y,r(s).start_date]]),r(s).errors.start_date?(l(),c("div",ge,m(r(s).errors.start_date),1)):p("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":t[4]||(t[4]=a=>r(s).end_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.end_date}]),required:""},null,2),[[y,r(s).end_date]]),r(s).errors.end_date?(l(),c("div",fe,m(r(s).errors.end_date),1)):p("",!0)])]),e("div",xe,[e("button",{type:"button",onClick:w,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(s).processing}," Update Date Blocker ",8,_e)])],32)])]),_:1},8,["show"])]))}},Ee=H(ye,[["__scopeId","data-v-a250e957"]]);export{Ee as default};
