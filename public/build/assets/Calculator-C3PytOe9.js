import{d as N,k as r,i as R,l as $,p as D,g as n,o as u,b as l,h as f,j as y,q,F as x,s as h,x as M,f as C,t as e}from"./app-5JzPwV80.js";const B={class:"my-7 max-w-7xl mx-auto p-10 bg-white rounded-2xl shadow space-y-10 border border-gray-500"},F={class:"space-y-2"},j=["value"],O={class:"space-y-2"},Q=["min","max","disabled"],X={key:0,class:"text-gray-700 mt-2 text-lg"},H={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},I={class:"space-y-2"},L={class:"space-y-2"},J={key:0,class:"space-y-2"},K=["value"],W={class:"text-right mt-10 space-y-4"},z={class:"text-2xl font-semibold text-gray-900"},G={key:0,class:"text-left mt-6 space-y-8 text-sm text-gray-800"},Y={class:"w-full border"},Z={class:"font-semibold border-t"},ll={class:"w-full border"},tl={class:"font-semibold border-t"},el={class:"w-full border"},al={class:"font-semibold border-t"},sl={key:0},ol={class:"w-full border"},nl={class:"p-2"},ul={class:"p-2"},dl={class:"font-semibold border-t"},pl=N({__name:"Calculator",setup(rl){const _=r([]),k=r([]),p=r(null),d=r(""),b=r(1),m=r(0),g=r(""),S=r(0),T=r(!1),a=r(null),v=R(()=>_.value.find(o=>o.id===p.value)),P=R(()=>{if(!v.value||!d.value)return"";const o=new Date(d.value),t=new Date(o);return t.setDate(o.getDate()+v.value.package_min_days),t.toISOString().split("T")[0]}),A=R(()=>{var i;const o=(i=v.value)==null?void 0:i.package_min_days;if(!o)return"";const t=o-1;return`${o} day${o>1?"s":""}, ${t} night${t!==1?"s":""}`}),U=async()=>{const t=await(await fetch("/calculator/api/get-resources")).json();_.value=t.packages},V=async()=>{const t=await(await fetch(`/calculator/api/get-room-types/${p.value}`)).json();k.value=t},E=async()=>{var o;if(!(!p.value||!d.value||!g.value)){T.value=!0;try{const t=((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||"",i=await fetch("/calculator/api/calculate-total",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({package_id:p.value,adults:b.value,children:m.value,travel_date:d.value,room_type:g.value})});if(!i.ok)throw new Error(`HTTP ${i.status}`);const c=await i.json();S.value=parseFloat(c.total),a.value=c.breakdown}catch(t){console.error("Calculation error:",t),a.value=null}finally{T.value=!1}}};return $(()=>{U()}),D([p,d,b,m,g],()=>{E()}),D(p,()=>{d.value="",V()}),(o,t)=>{var i,c;return u(),n("div",B,[t[35]||(t[35]=l("h1",{class:"text-3xl font-bold text-gray-800"},"Travel Fee Calculator",-1)),l("div",F,[t[6]||(t[6]=l("label",{class:"block text-lg font-medium text-gray-700"},"Select Package",-1)),y(l("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),class:"border border-gray-300 rounded-lg p-3 w-full"},[t[5]||(t[5]=l("option",{disabled:"",value:""},"-- Select a package --",-1)),(u(!0),n(x,null,h(_.value,s=>(u(),n("option",{key:s.id,value:s.id},e(s.name),9,j))),128))],512),[[q,p.value]])]),l("div",O,[t[7]||(t[7]=l("label",{class:"block text-lg font-medium text-gray-700"},"Travel Start Date",-1)),y(l("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>d.value=s),class:"border border-gray-300 rounded-lg p-3 w-full",min:(i=v.value)==null?void 0:i.package_start_date,max:(c=v.value)==null?void 0:c.package_end_date,disabled:!v.value},null,8,Q),[[M,d.value]])]),d.value&&v.value?(u(),n("div",X,[l("p",null,[t[8]||(t[8]=C("Start Date: ")),l("strong",null,e(d.value),1)]),l("p",null,[t[9]||(t[9]=C("End Date: ")),l("strong",null,e(P.value),1)]),l("p",null,[t[10]||(t[10]=C("Duration: ")),l("strong",null,e(A.value),1)])])):f("",!0),l("div",H,[l("div",I,[t[11]||(t[11]=l("label",{class:"block text-lg font-medium text-gray-700"},"Number of Adults",-1)),y(l("input",{type:"number",min:"1","onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),class:"border border-gray-300 rounded-lg p-3 w-full"},null,512),[[M,b.value]])]),l("div",L,[t[12]||(t[12]=l("label",{class:"block text-lg font-medium text-gray-700"},"Number of Children",-1)),y(l("input",{type:"number",min:"0","onUpdate:modelValue":t[3]||(t[3]=s=>m.value=s),class:"border border-gray-300 rounded-lg p-3 w-full"},null,512),[[M,m.value]])]),k.value.length>0?(u(),n("div",J,[t[14]||(t[14]=l("label",{class:"block text-lg font-medium text-gray-700"},"Room Type",-1)),y(l("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>g.value=s),class:"border border-gray-300 rounded-lg p-3 w-full"},[t[13]||(t[13]=l("option",{disabled:"",value:""},"-- Select a room type --",-1)),(u(!0),n(x,null,h(k.value,s=>(u(),n("option",{key:s,value:s},e(s),9,K))),128))],512),[[q,g.value]])])):f("",!0)]),l("div",W,[l("p",z,e(T.value?"Calculating...":`Total Price: RM ${S.value.toFixed(2)}`),1),a.value?(u(),n("div",G,[l("div",null,[t[19]||(t[19]=l("h2",{class:"font-semibold text-lg mb-2"},"Base Charge",-1)),l("table",Y,[t[18]||(t[18]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[15]||(t[15]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(a.value.base_charge.per_adult),1),l("td",null,e(a.value.base_charge.adult_qty),1),l("td",null,"RM "+e(a.value.base_charge.adult_total),1)]),l("tr",null,[t[16]||(t[16]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(a.value.base_charge.per_child),1),l("td",null,e(a.value.base_charge.child_qty),1),l("td",null,"RM "+e(a.value.base_charge.child_total),1)]),l("tr",Z,[t[17]||(t[17]=l("td",{colspan:"3",class:"p-2"},"Total Base Charge",-1)),l("td",null,"RM "+e(a.value.base_charge.total),1)])])])]),l("div",null,[t[24]||(t[24]=l("h2",{class:"font-semibold text-lg mb-2"},"Surcharge",-1)),l("table",ll,[t[23]||(t[23]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[20]||(t[20]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(a.value.surcharge.per_adult),1),l("td",null,e(a.value.surcharge.adult_qty),1),l("td",null,"RM "+e(a.value.surcharge.adult_total),1)]),l("tr",null,[t[21]||(t[21]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(a.value.surcharge.per_child),1),l("td",null,e(a.value.surcharge.child_qty),1),l("td",null,"RM "+e(a.value.surcharge.child_total),1)]),l("tr",tl,[t[22]||(t[22]=l("td",{colspan:"3",class:"p-2"},"Total Surcharge",-1)),l("td",null,"RM "+e(a.value.surcharge.total),1)])])])]),l("div",null,[t[29]||(t[29]=l("h2",{class:"font-semibold text-lg mb-2"},"Extra Charges",-1)),l("table",el,[t[28]||(t[28]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[25]||(t[25]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(a.value.extra_charges.per_adult),1),l("td",null,e(a.value.extra_charges.adult_qty),1),l("td",null,"RM "+e(a.value.extra_charges.adult_total),1)]),l("tr",null,[t[26]||(t[26]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(a.value.extra_charges.per_child),1),l("td",null,e(a.value.extra_charges.child_qty),1),l("td",null,"RM "+e(a.value.extra_charges.child_total),1)]),l("tr",al,[t[27]||(t[27]=l("td",{colspan:"3",class:"p-2"},"Total Extra Charges",-1)),l("td",null,"RM "+e(a.value.extra_charges.total),1)])])])]),a.value.add_ons.items.length?(u(),n("div",sl,[t[34]||(t[34]=l("h2",{class:"font-semibold text-lg mb-2"},"Selected Add-ons",-1)),l("table",ol,[t[33]||(t[33]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Add-on"),l("th",null,"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[(u(!0),n(x,null,h(a.value.add_ons.items,(s,w)=>(u(),n("tr",{key:w+"-adult"},[l("td",nl,e(s.name),1),t[30]||(t[30]=l("td",null,"Adult",-1)),l("td",null,"RM "+e(s.adult_price),1),l("td",null,e(s.adult_qty),1),l("td",null,"RM "+e(s.adult_total),1)]))),128)),(u(!0),n(x,null,h(a.value.add_ons.items,(s,w)=>(u(),n("tr",{key:w+"-child"},[l("td",ul,e(s.name),1),t[31]||(t[31]=l("td",null,"Child",-1)),l("td",null,"RM "+e(s.child_price),1),l("td",null,e(s.child_qty),1),l("td",null,"RM "+e(s.child_total),1)]))),128)),l("tr",dl,[t[32]||(t[32]=l("td",{colspan:"4",class:"p-2"},"Total Add-ons",-1)),l("td",null,"RM "+e(a.value.add_ons.total),1)])])])])):f("",!0)])):f("",!0)])])}}});export{pl as default};
