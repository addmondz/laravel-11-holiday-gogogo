import{d as E,i as B,j as P,v as F,o as d,g as h,C as N,r as w,k as $,l as U,c as x,w as v,a as r,h as b,b as l,u as t,m as M,t as j,e as q,P as z,f as R,n as A}from"./app-Bxp7JV8d.js";import{_ as H}from"./GuestLayout.vue_vue_type_script_setup_true_lang-B_2jJuvl.js";import{_ as S,a as T,b as I}from"./TextInput.vue_vue_type_script_setup_true_lang-CFBtBl6v.js";import{P as K}from"./PrimaryButton-Dz-a_gnZ.js";import"./ApplicationLogo-DE9J2l7n.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O=["value"],W=E({__name:"Checkbox",props:{checked:{type:Boolean},value:{}},emits:["update:checked"],setup(g,{emit:u}){const e=u,c=g,m=B({get(){return c.checked},set(a){e("update:checked",a)}});return(a,n)=>P((d(),h("input",{type:"checkbox",value:a.value,"onUpdate:modelValue":n[0]||(n[0]=f=>m.value=f),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:focus:ring-indigo-600 dark:focus:ring-offset-gray-800"},null,8,O)),[[F,m.value]])}}),G={key:0,class:"mb-4 text-sm font-medium text-green-600"},J={key:1,class:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-700"},Q={class:"mt-4"},X={class:"mt-4 block flex justify-between"},Y={class:"flex items-center"},Z={class:"mt-4"},L=20*60*1e3,ae=E({__name:"Login",props:{canResetPassword:{type:Boolean},status:{},csrfToken:{}},setup(g){const u=g,e=N({email:"",password:"",remember:!1}),c=w(!1);w(!1);const m=w(!1),a=async()=>{if(!c.value)return new Promise(o=>{c.value=!0,m.value=!0,sessionStorage.setItem("login_email",e.email),sessionStorage.setItem("login_remember",String(e.remember)),window.location.reload()})};let n=Date.now();const f=()=>{document.visibilityState==="visible"&&Date.now()-n>L&&a().then(()=>{n=Date.now()})},k=()=>{Date.now()-n>L&&a().then(()=>{n=Date.now()})};let p=null;const _=()=>{p&&clearTimeout(p),p=setTimeout(()=>{Date.now()-n>10*60*1e3&&a().then(()=>{n=Date.now()})},500)},C=()=>{V()},V=()=>{e.post(route("login"),{onError:o=>{},onCancelToken:o=>{},onFinish:()=>{sessionStorage.removeItem("login_email"),sessionStorage.removeItem("login_remember"),e.reset("password"),window.location.href=route("dashboard")}})};return $(()=>{const o=sessionStorage.getItem("login_email"),s=sessionStorage.getItem("login_remember");o&&(e.email=o,sessionStorage.removeItem("login_email")),s==="true"&&(e.remember=!0,sessionStorage.removeItem("login_remember")),u.csrfToken&&window.updateCsrfToken&&(window.updateCsrfToken(u.csrfToken),n=Date.now()),document.addEventListener("visibilitychange",f),window.addEventListener("focus",k);const i=document.getElementById("email"),y=document.getElementById("password");i&&i.addEventListener("focus",_),y&&y.addEventListener("focus",_);const D=setInterval(()=>{a().then(()=>{n=Date.now()})},20*60*1e3);window.__loginTokenRefreshInterval=D}),U(()=>{document.removeEventListener("visibilitychange",f),window.removeEventListener("focus",k),window.__loginTokenRefreshInterval&&clearInterval(window.__loginTokenRefreshInterval)}),(o,s)=>(d(),x(H,null,{default:v(()=>[r(t(M),{title:"Log in"}),o.status?(d(),h("div",G,j(o.status),1)):b("",!0),m.value?(d(),h("div",J," Session expired. Refreshing page... ")):b("",!0),l("form",{onSubmit:q(C,["prevent"])},[l("div",null,[r(S,{for:"email",value:"Email"}),r(T,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:t(e).email,"onUpdate:modelValue":s[0]||(s[0]=i=>t(e).email=i),required:"",autofocus:"",autocomplete:"username"},null,8,["modelValue"]),r(I,{class:"mt-2",message:t(e).errors.email},null,8,["message"])]),l("div",Q,[r(S,{for:"password",value:"Password"}),r(T,{id:"password",type:"password",class:"mt-1 block w-full",modelValue:t(e).password,"onUpdate:modelValue":s[1]||(s[1]=i=>t(e).password=i),required:"",autocomplete:"current-password"},null,8,["modelValue"]),r(I,{class:"mt-2",message:t(e).errors.password},null,8,["message"])]),l("div",X,[l("label",Y,[r(W,{name:"remember",checked:t(e).remember,"onUpdate:checked":s[2]||(s[2]=i=>t(e).remember=i)},null,8,["checked"]),s[3]||(s[3]=l("span",{class:"ms-2 text-sm text-gray-600 dark:text-gray-400"},"Remember me",-1))]),o.canResetPassword?(d(),x(t(z),{key:0,href:o.route("password.request"),class:"rounded-md text-sm text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:text-gray-400 dark:hover:text-gray-100 dark:focus:ring-offset-gray-800 hover:underline"},{default:v(()=>s[4]||(s[4]=[R(" Forgot your password? ")])),_:1},8,["href"])):b("",!0)]),l("div",Z,[r(K,{class:A(["bg-indigo-500 hover:bg-indigo-600 w-full flex justify-center active:bg-indigo-700 focus:bg-indigo-700",{"opacity-25":t(e).processing}]),disabled:t(e).processing},{default:v(()=>s[5]||(s[5]=[R(" Log in ")])),_:1},8,["class","disabled"])])],32)]),_:1}))}});export{ae as default};
