import{C as I,l as L,i as F,y as M,g as d,o as n,a as k,u as s,m as S,w as h,b as e,e as N,j as u,h as p,k as g,t as _,F as v,p as U,n as D,P as $,f as G}from"./app-B_tqemoV.js";import{A as z}from"./AuthenticatedLayout-DIeyrQPE.js";import{S as f}from"./sweetalert2.esm.all-B0Dix5B2.js";import{_ as K}from"./BreadcrumbComponent-CT_9v1Kq.js";import{u as q}from"./vue-router-Qc5Rakvw.js";import"./ApplicationLogo-Ca00IMMS.js";import"./LoadingComponent-BOOzNdka.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AntdIcon-DZPRhGK_.js";const A={class:"pb-12 pt-6"},J={class:"max-w-9xl mx-auto sm:px-6 lg:px-8"},H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 text-gray-900"},W={class:"grid grid-cols-1 gap-6"},X={key:0,class:"mt-1 text-sm text-red-600"},Y={key:0,class:"mt-1 text-sm text-red-600"},Z={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},ee={class:"space-y-1 text-center"},te={key:0,class:"flex gap-4 mb-4"},ae=["src"],se=["onClick"],oe={class:"text-sm text-gray-600"},ie={class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},re={key:0,class:"mt-1 text-sm text-red-600"},de={class:"hidden"},ne={key:0,class:"mt-1 text-sm text-red-600"},le={class:"grid grid-cols-2 gap-6"},ce={key:0,class:"mt-1 text-sm text-red-600"},me={key:0,class:"mt-1 text-sm text-red-600"},pe={key:0,class:"mt-1 text-sm text-red-600"},ue={key:0,class:"mt-1 text-sm text-red-600"},ge={class:"grid grid-cols-2 gap-6"},_e=["max"],fe={key:0,class:"mt-1 text-sm text-red-600"},xe=["min"],ye={key:0,class:"mt-1 text-sm text-red-600"},be={key:1,class:"mt-1 text-sm text-red-600"},ke={class:"mt-6 border-t border-gray-600 pt-6"},he={class:"overflow-x-auto"},ve={class:"min-w-full divide-y divide-gray-200"},we={class:"bg-white divide-y divide-gray-200"},Ue={class:"px-6 py-4 whitespace-nowrap"},De=["onUpdate:modelValue"],Ve={class:"px-6 py-4 whitespace-nowrap"},Pe=["onUpdate:modelValue"],Oe={class:"px-6 py-4"},je=["onUpdate:modelValue"],Ce={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Re=["onClick"],Ee={class:"mt-6 flex justify-end"},Te=["disabled"],ze={__name:"Duplicate",props:{package:Object},setup(V){const c=V,t=I({name:c.package.name,description:c.package.description,images:c.package.images||[],display_price_adult:c.package.display_price_adult,display_price_child:c.package.display_price_child,package_min_days:c.package.package_min_days,package_max_days:c.package.package_max_days,terms_and_conditions:c.package.terms_and_conditions,location:c.package.location,package_start_date:c.package.package_start_date,package_end_date:c.package.package_end_date,room_types:c.package.room_types.map(r=>({name:r.name,max_occupancy:r.max_occupancy,description:r.description}))}),x=L("");q();const P=()=>{t.room_types.push({name:"",max_occupancy:4,description:""})},O=r=>{t.room_types.splice(r,1)},j=r=>{t.icon_photo=r.target.files[0]},C=r=>{const a=Array.from(r.target.files),o=10*1024*1024,l=["image/jpeg","image/png","image/gif"],i=[];if(a.forEach(m=>{l.includes(m.type)||i.push(`${m.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),m.size>o&&i.push(`${m.name} is too large. Maximum file size is 10MB.`)}),i.length>0){f.fire({title:"Invalid Images",html:i.join("<br>"),icon:"error",confirmButtonText:"OK"});return}t.images=[...t.images,...a]},R=r=>{t.images[r],t.images.splice(r,1)},E=r=>typeof r=="string"?`/storage/${r}`:typeof window<"u"&&window.URL&&window.URL.createObjectURL?URL.createObjectURL(r):"",w=()=>{if(x.value="",t.package_start_date&&t.package_end_date){const r=new Date(t.package_start_date),a=new Date(t.package_end_date),o=Math.abs(a-r),l=Math.ceil(o/(1e3*60*60*24));a<=r?x.value="End date must be after start date":l<1&&(x.value="End date must be at least one day after start date")}},T=()=>{const a=["image/jpeg","image/png","image/gif"],o=[];if(t.images.forEach(i=>{i instanceof File&&(a.includes(i.type)||o.push(`${i.name} is not a valid image file. Only JPG, PNG, and GIF are allowed.`),i.size>10485760&&o.push(`${i.name} is too large. Maximum file size is 10MB.`))}),o.length>0){f.fire({title:"Invalid Images",html:o.join("<br>"),icon:"error",confirmButtonText:"OK"});return}const l=new FormData;if(Object.keys(t).forEach(i=>{i==="images"?t.images.forEach((m,y)=>{m instanceof File?l.append(`images[${y}]`,m):typeof m=="string"&&l.append(`existing_images[${y}]`,m)}):l.append(i,t[i])}),w(),x.value){f.fire({title:"Validation Error",text:x.value,icon:"error",confirmButtonText:"OK"});return}axios.post(route("packages.duplicate",c.package.id),l,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{f.fire({title:"Success!",text:"Package has been duplicated successfully.",icon:"success",confirmButtonText:"OK"}).then(()=>{window.location.href=route("packages.index")})}).catch(i=>{var m,y;if((y=(m=i.response)==null?void 0:m.data)!=null&&y.errors){const b=i.response.data.errors;b.package_end_date?f.fire({title:"Validation Error",text:b.package_end_date[0],icon:"error",confirmButtonText:"OK"}):b.images?f.fire({title:"Validation Error",html:b.images.join("<br>"),icon:"error",confirmButtonText:"OK"}):f.fire({title:"Error",text:"Failed to duplicate package. Please try again.",icon:"error",confirmButtonText:"OK"})}else f.fire({title:"Error",text:"Failed to duplicate package. Please try again.",icon:"error",confirmButtonText:"OK"})})},B=F(()=>[{title:"Packages",link:route("packages.index")},{title:"Duplicate Package"}]);return M(()=>{t.images.forEach(r=>{r instanceof File&&URL.revokeObjectURL(URL.createObjectURL(r))})}),(r,a)=>(n(),d(v,null,[k(s(S),{title:"Duplicate Package"}),k(z,null,{header:h(()=>a[8]||(a[8]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},null,-1)])),default:h(()=>[e("div",A,[e("div",J,[e("div",H,[e("div",Q,[k(K,{breadcrumbs:B.value,class:"mb-9"},null,8,["breadcrumbs"]),e("form",{onSubmit:N(T,["prevent"])},[e("div",W,[e("div",null,[a[9]||(a[9]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),u(e("input",{type:"text",id:"name","onUpdate:modelValue":a[0]||(a[0]=o=>s(t).name=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[g,s(t).name]]),s(t).errors.name?(n(),d("div",X,_(s(t).errors.name),1)):p("",!0)]),e("div",null,[a[10]||(a[10]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),u(e("textarea",{id:"description","onUpdate:modelValue":a[1]||(a[1]=o=>s(t).description=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,s(t).description]]),s(t).errors.description?(n(),d("div",Y,_(s(t).errors.description),1)):p("",!0)]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Package Images",-1)),e("div",Z,[e("div",ee,[s(t).images&&s(t).images.length>0?(n(),d("div",te,[(n(!0),d(v,null,U(s(t).images,(o,l)=>(n(),d("div",{key:l,class:"relative group"},[e("img",{src:E(o),class:"h-24 w-full object-cover rounded-lg",alt:"Package image"},null,8,ae),e("button",{type:"button",onClick:i=>R(l),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition-opacity"},a[11]||(a[11]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,se)]))),128))])):p("",!0),e("div",oe,[e("label",ie,[a[12]||(a[12]=e("span",null,"Upload Images",-1)),e("input",{type:"file",onChange:C,accept:"image/*",multiple:"",class:"sr-only"},null,32)])]),a[13]||(a[13]=e("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 10MB",-1))])]),s(t).errors.images?(n(),d("div",re,_(s(t).errors.images),1)):p("",!0)]),e("div",de,[a[15]||(a[15]=e("label",{for:"icon_photo",class:"block text-sm font-medium text-gray-700"},"Icon Photo",-1)),e("input",{type:"file",id:"icon_photo",onChange:j,accept:"image/*",class:"mt-1 block w-full"},null,32),s(t).errors.icon_photo?(n(),d("div",ne,_(s(t).errors.icon_photo),1)):p("",!0)]),e("div",le,[e("div",null,[a[16]||(a[16]=e("label",{for:"display_price_adult",class:"block text-sm font-medium text-gray-700"},"Display Price",-1)),u(e("input",{type:"number",id:"display_price_adult","onUpdate:modelValue":a[2]||(a[2]=o=>s(t).display_price_adult=o),step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,s(t).display_price_adult]]),s(t).errors.display_price_adult?(n(),d("div",ce,_(s(t).errors.display_price_adult),1)):p("",!0)]),e("div",null,[a[17]||(a[17]=e("label",{for:"package_min_days",class:"block text-sm font-medium text-gray-700"},"Package Duration (Nights)",-1)),u(e("input",{type:"number",id:"package_min_days","onUpdate:modelValue":a[3]||(a[3]=o=>s(t).package_min_days=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[g,s(t).package_min_days]]),s(t).errors.package_min_days?(n(),d("div",me,_(s(t).errors.package_min_days),1)):p("",!0)])]),e("div",null,[a[18]||(a[18]=e("label",{for:"terms_and_conditions",class:"block text-sm font-medium text-gray-700"},"Terms and Conditions",-1)),u(e("textarea",{id:"terms_and_conditions","onUpdate:modelValue":a[4]||(a[4]=o=>s(t).terms_and_conditions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,s(t).terms_and_conditions]]),s(t).errors.terms_and_conditions?(n(),d("div",pe,_(s(t).errors.terms_and_conditions),1)):p("",!0)]),e("div",null,[a[19]||(a[19]=e("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Location",-1)),u(e("input",{type:"text",id:"location","onUpdate:modelValue":a[5]||(a[5]=o=>s(t).location=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,s(t).location]]),s(t).errors.location?(n(),d("div",ue,_(s(t).errors.location),1)):p("",!0)]),e("div",ge,[e("div",null,[a[20]||(a[20]=e("label",{for:"package_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),u(e("input",{type:"date",id:"package_start_date","onUpdate:modelValue":a[6]||(a[6]=o=>s(t).package_start_date=o),max:s(t).package_end_date?s(t).package_end_date:void 0,class:D(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":s(t).errors.package_start_date||s(t).errors.package_end_date}]),required:"",onChange:w},null,42,_e),[[g,s(t).package_start_date]]),s(t).errors.package_start_date?(n(),d("div",fe,_(s(t).errors.package_start_date),1)):p("",!0)]),e("div",null,[a[21]||(a[21]=e("label",{for:"package_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),u(e("input",{type:"date",id:"package_end_date","onUpdate:modelValue":a[7]||(a[7]=o=>s(t).package_end_date=o),min:s(t).package_start_date?new Date(new Date(s(t).package_start_date).getTime()+864e5).toISOString().split("T")[0]:void 0,class:D(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":s(t).errors.package_end_date}]),required:""},null,10,xe),[[g,s(t).package_end_date]]),s(t).errors.package_end_date?(n(),d("div",ye,_(s(t).errors.package_end_date),1)):p("",!0),x.value?(n(),d("div",be,_(x.value),1)):p("",!0)])]),e("div",ke,[e("div",{class:"flex justify-between items-center mb-4"},[a[22]||(a[22]=e("h3",{class:"text-lg font-medium text-gray-900"},"Room Types",-1)),e("button",{type:"button",onClick:P,class:"px-4 py-2 text-xs bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200"}," Add Room Type ")]),e("div",he,[e("table",ve,[a[23]||(a[23]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Room Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Max Occupancy"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",we,[(n(!0),d(v,null,U(s(t).room_types,(o,l)=>(n(),d("tr",{key:l},[e("td",Ue,[u(e("input",{type:"text","onUpdate:modelValue":i=>o.name=i,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Room Type Name",required:""},null,8,De),[[g,o.name]])]),e("td",Ve,[u(e("input",{type:"number","onUpdate:modelValue":i=>o.max_occupancy=i,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"1",required:""},null,8,Pe),[[g,o.max_occupancy]])]),e("td",Oe,[u(e("input",{type:"text","onUpdate:modelValue":i=>o.description=i,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Description"},null,8,je),[[g,o.description]])]),e("td",Ce,[e("button",{type:"button",onClick:i=>O(l),class:"text-red-600 hover:text-red-900"}," Remove ",8,Re)])]))),128))])])])])]),e("div",Ee,[k(s($),{href:r.route("packages.index"),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 mr-3 text-xs"},{default:h(()=>a[24]||(a[24]=[G(" Cancel ")])),_:1},8,["href"]),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:s(t).processing}," Create Duplicate ",8,Te)])],32)])])])])]),_:1})],64))}};export{ze as default};
