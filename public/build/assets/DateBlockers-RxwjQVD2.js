import{l as f,C as q,D as K,g as i,o as n,b as e,a as E,h as _,F,q as V,c as G,w as T,f as H,t as c,e as U,j as y,n as v,u as r,k as b,p as J,x as N}from"./app-nJ6SZMN9.js";import{_ as L}from"./Modal.vue_vue_type_script_setup_true_lang-BQjVOZHt.js";import{P as Q}from"./Pagination-B5KzL7bQ.js";import{h as k}from"./moment-C5S46NFB.js";import{S as m}from"./sweetalert2.esm.all-B0Dix5B2.js";import{L as W}from"./LoadingComponent-CFYw0Fkv.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"space-y-6"},ee={class:"flex justify-between items-center"},te={class:"overflow-x-auto"},oe={key:0,class:"flex justify-center items-center h-full min-h-[400px]"},re={key:1,class:"min-w-full divide-y divide-gray-200"},se={class:"bg-white divide-y divide-gray-200"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},le={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ie=["onClick"],ue=["onClick"],ce={key:0},pe={class:"mt-4"},me={class:"p-6"},ge={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded relative"},fe={class:"grid grid-cols-1 gap-6"},_e={key:0,class:"mt-1 text-sm text-red-600"},ye={key:0,class:"mt-1 text-sm text-red-600"},xe=["value"],ve={class:"mt-6 flex justify-end space-x-3"},be=["disabled"],ke={class:"p-6"},he={class:"grid grid-cols-1 gap-6"},we={key:0,class:"mt-1 text-sm text-red-600"},De={key:0,class:"mt-1 text-sm text-red-600"},Be={class:"mt-6 flex justify-end space-x-3"},Ce=["disabled"],Ee={__name:"DateBlockers",props:{packageId:{type:Number,required:!0},package:{type:Object,required:!0},packageUniqueRoomTypes:{type:Object,required:!0}},setup(M){const A=M,l=f({data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10}),u=f(""),S=f(0),h=f(!1),w=f(!1),D=f(!0),d=q({package_id:A.packageId,start_date:"",end_date:"",room_type_id:""}),a=q({id:null,start_date:"",end_date:""}),g=async(o=1)=>{try{const t=await N.get(route("date-blockers.index"),{params:{package_id:A.packageId,page:o}});l.value=t.data,D.value=!1}catch(t){console.error("Error fetching date blockers:",t),D.value=!1}},P=async o=>{try{await g(o),S.value++}catch(t){console.error("Error changing page:",t)}},R=()=>{d.post(route("date-blockers.store"),{preserveScroll:!0,onSuccess:()=>{B(),g(l.value.current_page),m.fire({title:"Success!",text:d.recentlySuccessful?"Date blocker added successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.room_type_id?u.value=Array.isArray(o.room_type_id)?o.room_type_id.join(", "):o.room_type_id:o.date_range?u.value=Array.isArray(o.date_range)?o.date_range.join(", "):o.date_range:o.start_date?u.value=Array.isArray(o.start_date)?o.start_date.join(", "):o.start_date:o.end_date?u.value=Array.isArray(o.end_date)?o.end_date.join(", "):o.end_date:o.error?u.value=Array.isArray(o.error)?o.error.join(", "):o.error:u.value="An unexpected error occurred. Please try again."}})},$=()=>{a.put(route("date-blockers.update",a.id),{preserveScroll:!0,onSuccess:()=>{C(),g(l.value.current_page),m.fire({title:"Success!",text:a.recentlySuccessful?"Date blocker updated successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.date_range?m.fire({title:"Error!",text:o.date_range,icon:"error",confirmButtonColor:"#4F46E5"}):o.error&&m.fire({title:"Error!",text:o.error,icon:"error",confirmButtonColor:"#4F46E5"})}})},I=async o=>{var s,p,x,Y;if((await m.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await N.delete(route("date-blockers.destroy",o)),l.value.data.length===1&&l.value.current_page>1?await g(l.value.current_page-1):await g(l.value.current_page),m.fire({title:"Deleted!",text:"Date blocker has been deleted.",icon:"success",confirmButtonColor:"#4F46E5"})}catch(j){const z=((p=(s=j.response)==null?void 0:s.data)==null?void 0:p.message)||((Y=(x=j.response)==null?void 0:x.data)==null?void 0:Y.error)||"Error deleting date blocker";m.fire({title:"Error!",text:z,icon:"error",confirmButtonColor:"#4F46E5"})}},O=o=>{a.id=o.id,a.start_date=k(o.start_date).format("YYYY-MM-DD"),a.end_date=k(o.end_date).format("YYYY-MM-DD"),w.value=!0},B=()=>{h.value=!1,d.reset(),d.clearErrors(),u.value=""},C=()=>{w.value=!1,a.reset(),a.clearErrors()};return K(()=>{g()}),(o,t)=>(n(),i("div",Z,[e("div",ee,[t[7]||(t[7]=e("h3",{class:"text-md font-medium text-gray-900"},"Date Blockers",-1)),e("button",{onClick:t[0]||(t[0]=s=>h.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Date Blocker ")]),e("div",te,[D.value?(n(),i("div",oe,[E(W)])):(n(),i("table",re,[t[9]||(t[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," End Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Room Type "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",se,[(n(!0),i(F,null,V(l.value.data,s=>{var p;return n(),i("tr",{key:s.id},[e("td",ae,c(r(k)(s.start_date).format("DD/MM/YYYY")),1),e("td",de,c(r(k)(s.end_date).format("DD/MM/YYYY")),1),e("td",ne,c((p=s.room_type)==null?void 0:p.name),1),e("td",le,[e("button",{onClick:x=>O(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,ie),e("button",{onClick:x=>I(s.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ue)])])}),128)),l.value.data.length===0?(n(),i("tr",ce,t[8]||(t[8]=[e("td",{colspan:"3",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"}," No date blockers found ",-1)]))):_("",!0)])]))]),e("div",pe,[(n(),G(Q,{links:l.value.links,from:l.value.from,to:l.value.to,total:l.value.total,"component-loading":!0,onPageChange:P,key:S.value},null,8,["links","from","to","total"]))]),E(L,{show:h.value,onClose:B},{default:T(()=>[e("div",me,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Date Blocker",-1)),u.value?(n(),i("div",ge,[e("button",{onClick:t[1]||(t[1]=s=>u.value=""),class:"absolute top-2 right-2 text-red-700 hover:text-red-900"},t[10]||(t[10]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),H(" "+c(u.value),1)])):_("",!0),e("form",{onSubmit:U(R,["prevent"])},[e("div",fe,[e("div",null,[t[11]||(t[11]=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),y(e("input",{type:"date",id:"start_date","onUpdate:modelValue":t[2]||(t[2]=s=>r(d).start_date=s),class:v(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.start_date}]),required:""},null,2),[[b,r(d).start_date]]),r(d).errors.start_date?(n(),i("div",_e,c(r(d).errors.start_date),1)):_("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),y(e("input",{type:"date",id:"end_date","onUpdate:modelValue":t[3]||(t[3]=s=>r(d).end_date=s),class:v(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.end_date}]),required:""},null,2),[[b,r(d).end_date]]),r(d).errors.end_date?(n(),i("div",ye,c(r(d).errors.end_date),1)):_("",!0)]),e("div",null,[t[14]||(t[14]=e("label",{for:"room_type_id",class:"block text-sm font-medium text-gray-700"},"Room Type",-1)),y(e("select",{id:"room_type_id","onUpdate:modelValue":t[4]||(t[4]=s=>r(d).room_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[13]||(t[13]=e("option",{value:""},"Select Room Type",-1)),(n(!0),i(F,null,V(M.packageUniqueRoomTypes,(s,p)=>(n(),i("option",{value:p,key:p},c(s),9,xe))),128))],512),[[J,r(d).room_type_id]])])]),e("div",ve,[e("button",{type:"button",onClick:B,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(d).processing}," Add Date Blocker ",8,be)])],32)])]),_:1},8,["show"]),E(L,{show:w.value,onClose:C},{default:T(()=>[e("div",ke,[t[18]||(t[18]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Date Blocker",-1)),e("form",{onSubmit:U($,["prevent"])},[e("div",he,[e("div",null,[t[16]||(t[16]=e("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),y(e("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":t[5]||(t[5]=s=>r(a).start_date=s),class:v(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(a).errors.start_date}]),required:""},null,2),[[b,r(a).start_date]]),r(a).errors.start_date?(n(),i("div",we,c(r(a).errors.start_date),1)):_("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),y(e("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":t[6]||(t[6]=s=>r(a).end_date=s),class:v(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(a).errors.end_date}]),required:""},null,2),[[b,r(a).end_date]]),r(a).errors.end_date?(n(),i("div",De,c(r(a).errors.end_date),1)):_("",!0)])]),e("div",Be,[e("button",{type:"button",onClick:C,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(a).processing}," Update Date Blocker ",8,Ce)])],32)])]),_:1},8,["show"])]))}},Ve=X(Ee,[["__scopeId","data-v-095861cf"]]);export{Ve as default};
