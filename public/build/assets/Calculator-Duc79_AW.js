import{d as U,k as u,i as b,l as E,p as D,g as o,o as n,b as l,h as _,j as f,q as V,F as k,s as M,x as C,f as y,t as e,n as $}from"./app-CG7sjmso.js";const B={class:"my-7 max-w-7xl mx-auto p-10 bg-white rounded-2xl shadow space-y-10 border border-gray-500"},j={class:"space-y-2"},Q=["value"],I={key:0,class:"space-y-3"},X={key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},H=["onClick"],L={class:"font-semibold text-lg text-gray-800"},z={class:"text-sm text-gray-600"},J={class:"text-sm text-gray-700"},K={key:1,class:"text-gray-500 italic"},W={class:"space-y-2"},G=["min","max","disabled"],Y={key:1,class:"text-gray-700 mt-2 text-lg"},Z={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},ll={class:"space-y-2"},tl={class:"space-y-2"},el={class:"text-right mt-10 space-y-4"},al={class:"text-2xl font-semibold text-gray-900"},sl={key:0,class:"text-left mt-6 space-y-8 text-sm text-gray-800"},dl={class:"w-full border"},ol={class:"font-semibold border-t"},nl={class:"w-full border"},rl={class:"font-semibold border-t"},ul={class:"w-full border"},il={class:"font-semibold border-t"},cl={key:0},gl={class:"w-full border"},vl={class:"p-2"},pl={class:"p-2"},bl={class:"font-semibold border-t"},xl=U({__name:"Calculator",setup(yl){const R=u([]),S=u([]),i=u(null),g=u([]),r=u(""),m=u(1),x=u(0),A=u(0),T=u(!1),s=u(null),v=b(()=>R.value.find(d=>d.id===i.value)),w=b(()=>S.value.filter(d=>d.package_id===i.value));b(()=>w.value.filter(d=>g.value.includes(d.id)));const q=b(()=>{if(!v.value||!r.value)return"";const d=new Date(r.value),t=new Date(d);return t.setDate(d.getDate()+v.value.package_min_days),t.toISOString().split("T")[0]}),P=b(()=>{var c;const d=(c=v.value)==null?void 0:c.package_min_days;if(!d)return"";const t=d-1;return`${d} day${d>1?"s":""}, ${t} night${t!==1?"s":""}`}),F=d=>{const t=g.value.indexOf(d);t===-1?g.value.push(d):g.value.splice(t,1)},O=async()=>{const t=await(await fetch("/calculator/api/get-resources")).json();R.value=t.packages,S.value=t.addOns},N=async()=>{var d;if(!(!i.value||!r.value)){T.value=!0;try{const t=((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||"",c=await fetch("/calculator/api/calculate-total",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({package_id:i.value,add_on_ids:g.value,adults:m.value,children:x.value,travel_date:r.value})});if(!c.ok)throw new Error(`HTTP ${c.status}`);const p=await c.json();A.value=parseFloat(p.total),s.value=p.breakdown}catch(t){console.error("Calculation error:",t),s.value=null}finally{T.value=!1}}};return E(()=>{O()}),D([i,g,r,m,x],()=>{N()}),D(i,()=>{g.value=[],r.value=""}),(d,t)=>{var c,p;return n(),o("div",B,[t[34]||(t[34]=l("h1",{class:"text-3xl font-bold text-gray-800"},"Travel Fee Calculator",-1)),l("div",j,[t[5]||(t[5]=l("label",{class:"block text-lg font-medium text-gray-700"},"Select Package",-1)),f(l("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a),class:"border border-gray-300 rounded-lg p-3 w-full"},[t[4]||(t[4]=l("option",{disabled:"",value:""},"-- Select a package --",-1)),(n(!0),o(k,null,M(R.value,a=>(n(),o("option",{key:a.id,value:a.id},e(a.name),9,Q))),128))],512),[[V,i.value]])]),i.value?(n(),o("div",I,[t[7]||(t[7]=l("label",{class:"block text-lg font-medium text-gray-700"},"Select Add-ons",-1)),w.value.length?(n(),o("div",X,[(n(!0),o(k,null,M(w.value,a=>(n(),o("div",{key:a.id,onClick:h=>F(a.id),class:$(["cursor-pointer border rounded-xl p-4 space-y-2 transition",g.value.includes(a.id)?"bg-blue-100 border-blue-400 shadow":"bg-white hover:bg-gray-50 border-gray-300"])},[l("div",L,e(a.name),1),l("div",z,e(a.description),1),l("div",J,[y(" Adult: RM "+e(parseFloat(a.adult_price).toFixed(2)),1),t[6]||(t[6]=l("br",null,null,-1)),y(" Child: RM "+e(parseFloat(a.child_price).toFixed(2)),1)])],10,H))),128))])):(n(),o("div",K,"No add-ons available for this package."))])):_("",!0),l("div",W,[t[8]||(t[8]=l("label",{class:"block text-lg font-medium text-gray-700"},"Travel Start Date",-1)),f(l("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),class:"border border-gray-300 rounded-lg p-3 w-full",min:(c=v.value)==null?void 0:c.package_start_date,max:(p=v.value)==null?void 0:p.package_end_date,disabled:!v.value},null,8,G),[[C,r.value]])]),r.value&&v.value?(n(),o("div",Y,[l("p",null,[t[9]||(t[9]=y("Start Date: ")),l("strong",null,e(r.value),1)]),l("p",null,[t[10]||(t[10]=y("End Date: ")),l("strong",null,e(q.value),1)]),l("p",null,[t[11]||(t[11]=y("Duration: ")),l("strong",null,e(P.value),1)])])):_("",!0),l("div",Z,[l("div",ll,[t[12]||(t[12]=l("label",{class:"block text-lg font-medium text-gray-700"},"Number of Adults",-1)),f(l("input",{type:"number",min:"1","onUpdate:modelValue":t[2]||(t[2]=a=>m.value=a),class:"border border-gray-300 rounded-lg p-3 w-full"},null,512),[[C,m.value]])]),l("div",tl,[t[13]||(t[13]=l("label",{class:"block text-lg font-medium text-gray-700"},"Number of Children",-1)),f(l("input",{type:"number",min:"0","onUpdate:modelValue":t[3]||(t[3]=a=>x.value=a),class:"border border-gray-300 rounded-lg p-3 w-full"},null,512),[[C,x.value]])])]),l("div",el,[l("p",al,e(T.value?"Calculating...":`Total Price: RM ${A.value.toFixed(2)}`),1),s.value?(n(),o("div",sl,[l("div",null,[t[18]||(t[18]=l("h2",{class:"font-semibold text-lg mb-2"},"Base Charge",-1)),l("table",dl,[t[17]||(t[17]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[14]||(t[14]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(s.value.base_charge.per_adult),1),l("td",null,e(s.value.base_charge.adult_qty),1),l("td",null,"RM "+e(s.value.base_charge.adult_total),1)]),l("tr",null,[t[15]||(t[15]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(s.value.base_charge.per_child),1),l("td",null,e(s.value.base_charge.child_qty),1),l("td",null,"RM "+e(s.value.base_charge.child_total),1)]),l("tr",ol,[t[16]||(t[16]=l("td",{colspan:"3",class:"p-2"},"Total Base Charge",-1)),l("td",null,"RM "+e(s.value.base_charge.total),1)])])])]),l("div",null,[t[23]||(t[23]=l("h2",{class:"font-semibold text-lg mb-2"},"Surcharge",-1)),l("table",nl,[t[22]||(t[22]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[19]||(t[19]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(s.value.surcharge.per_adult),1),l("td",null,e(s.value.surcharge.adult_qty),1),l("td",null,"RM "+e(s.value.surcharge.adult_total),1)]),l("tr",null,[t[20]||(t[20]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(s.value.surcharge.per_child),1),l("td",null,e(s.value.surcharge.child_qty),1),l("td",null,"RM "+e(s.value.surcharge.child_total),1)]),l("tr",rl,[t[21]||(t[21]=l("td",{colspan:"3",class:"p-2"},"Total Surcharge",-1)),l("td",null,"RM "+e(s.value.surcharge.total),1)])])])]),l("div",null,[t[28]||(t[28]=l("h2",{class:"font-semibold text-lg mb-2"},"Extra Charges",-1)),l("table",ul,[t[27]||(t[27]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[l("tr",null,[t[24]||(t[24]=l("td",{class:"p-2"},"Adult",-1)),l("td",null,"RM "+e(s.value.extra_charges.per_adult),1),l("td",null,e(s.value.extra_charges.adult_qty),1),l("td",null,"RM "+e(s.value.extra_charges.adult_total),1)]),l("tr",null,[t[25]||(t[25]=l("td",{class:"p-2"},"Child",-1)),l("td",null,"RM "+e(s.value.extra_charges.per_child),1),l("td",null,e(s.value.extra_charges.child_qty),1),l("td",null,"RM "+e(s.value.extra_charges.child_total),1)]),l("tr",il,[t[26]||(t[26]=l("td",{colspan:"3",class:"p-2"},"Total Extra Charges",-1)),l("td",null,"RM "+e(s.value.extra_charges.total),1)])])])]),s.value.add_ons.items.length?(n(),o("div",cl,[t[33]||(t[33]=l("h2",{class:"font-semibold text-lg mb-2"},"Selected Add-ons",-1)),l("table",gl,[t[32]||(t[32]=l("thead",{class:"bg-gray-100"},[l("tr",null,[l("th",{class:"p-2"},"Add-on"),l("th",null,"Type"),l("th",null,"Unit Price"),l("th",null,"Qty"),l("th",null,"Total")])],-1)),l("tbody",null,[(n(!0),o(k,null,M(s.value.add_ons.items,(a,h)=>(n(),o("tr",{key:h+"-adult"},[l("td",vl,e(a.name),1),t[29]||(t[29]=l("td",null,"Adult",-1)),l("td",null,"RM "+e(a.adult_price),1),l("td",null,e(a.adult_qty),1),l("td",null,"RM "+e(a.adult_total),1)]))),128)),(n(!0),o(k,null,M(s.value.add_ons.items,(a,h)=>(n(),o("tr",{key:h+"-child"},[l("td",pl,e(a.name),1),t[30]||(t[30]=l("td",null,"Child",-1)),l("td",null,"RM "+e(a.child_price),1),l("td",null,e(a.child_qty),1),l("td",null,"RM "+e(a.child_total),1)]))),128)),l("tr",bl,[t[31]||(t[31]=l("td",{colspan:"4",class:"p-2"},"Total Add-ons",-1)),l("td",null,"RM "+e(s.value.add_ons.total),1)])])])])):_("",!0)])):_("",!0)])])}}});export{xl as default};
