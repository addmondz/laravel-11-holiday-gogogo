import{l as _,i as te,C as N,z as K,g as n,o as l,b as e,a as V,h as v,F as S,s as B,c as se,w as U,t as g,e as $,j as y,u,q as j,k as h,n as ae,y as W,W as de}from"./app-BE1RfCb_.js";import{_ as A}from"./Modal.vue_vue_type_script_setup_true_lang-Cg_Ujv9F.js";import{P as oe}from"./Pagination-CAwSqCQv.js";import{S as R}from"./sweetalert2.esm.all-B0Dix5B2.js";import{h as w}from"./moment-C5S46NFB.js";import"./LoadingComponent-RLCIfO3L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"space-y-6"},le={class:"flex justify-between items-center"},ne={class:"overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},me={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},_e=["onClick"],ye=["onClick"],fe={key:0},ve={class:"mt-4"},be={class:"p-6"},xe={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ke={class:"space-y-4"},he=["value"],we={class:"mt-6 flex justify-end space-x-3"},De=["disabled"],Ce={class:"p-6"},Se={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Be={class:"space-y-4"},Re=["value"],Te={class:"mt-6 flex justify-end space-x-3"},Ee=["disabled"],Me={class:"p-6"},qe={key:0,class:"mb-4"},Ye={class:"bg-gray-50 rounded-lg p-4"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ue={key:0,class:"bg-green-50 border border-green-200 rounded-md p-3"},$e={class:"flex items-center"},je={class:"text-sm font-medium text-green-800"},Ae={key:1,class:"bg-red-50 border border-red-200 rounded-md p-3"},Le={class:"flex items-center"},ze={class:"text-sm font-medium text-red-800"},Fe={class:"space-y-4"},Pe={class:"flex justify-between items-center mb-4"},Oe={class:"text-md font-medium text-gray-900 invisible"},Ne={class:"flex space-x-2"},Ke=["onClick","disabled"],We={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},Ie={class:"flex"},Ge={class:"ml-3"},He={class:"text-sm text-red-800"},Je={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md"},Qe={class:"flex"},Xe={class:"ml-3"},Ze={class:"text-sm text-green-800"},et={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},tt=["for"],st=["id","onUpdate:modelValue"],at=["value"],dt=["for"],ot=["id","onUpdate:modelValue"],rt=["for"],lt=["id","onUpdate:modelValue"],nt={class:"mt-6 flex justify-end space-x-3"},it=["disabled"],vt={__name:"DateTypesRanges",props:{package:{type:Object,required:!0},dateTypeRanges:{type:Object,required:!0},dateTypes:{type:Array,required:!0}},setup(T){const b=T,L=_(0),f=_(b.dateTypeRanges),k=_(!1),D=_(!1),p=_(""),m=_(""),i=_(null),E=_(!1),q=_(!1),x=_([{date_type_id:"",start_date:"",end_date:""}]),M=te(()=>({links:f.value.links,from:f.value.from,to:f.value.to,total:f.value.total})),c=N({date_type_id:"",start_date:"",end_date:"",package_id:b.package.id,return_to_package:!0}),r=N({id:null,date_type_id:"",start_date:"",end_date:"",package_id:b.package.id,return_to_package:!0});K(k,a=>{a||(p.value="")}),K(D,a=>{a||(m.value="")});const C=async a=>{try{const t=await W.get(route("packages.date-type-ranges",b.package.id),{params:{page:a}});f.value={...f.value,data:t.data.data,links:t.data.links,from:t.data.from,to:t.data.to,total:t.data.total,current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page},L.value++}catch(t){console.error("Error fetching date type ranges:",t)}},I=()=>{if(!c.date_type_id){p.value="Date type is required";return}if(!c.start_date){p.value="Start date is required";return}if(!c.end_date){p.value="End date is required";return}if(w(c.end_date).isBefore(c.start_date)){p.value="End date must be after start date";return}c.post(route("date-type-ranges.store"),{preserveScroll:!0,onSuccess:()=>{k.value=!1,c.reset(),R.fire({icon:"success",title:"Success",text:"Date type range created successfully"}),C(1)},onError:a=>{a.date_type_id?p.value=a.date_type_id:a.start_date?p.value=a.start_date:a.end_date?p.value=a.end_date:a.package_id?p.value=a.package_id:p.value="Failed to create date type range. Please try again."}})},G=a=>{r.reset(),r.id=a.id,r.date_type_id=a.date_type_id,r.start_date=w(a.start_date).format("YYYY-MM-DD"),r.end_date=w(a.end_date).format("YYYY-MM-DD"),r.package_id=parseInt(b.package.id),r.return_to_package=!0,D.value=!0},z=()=>{D.value=!1,r.reset(),m.value=""},H=()=>{if(!r.date_type_id){m.value="Date type is required";return}if(!r.start_date){m.value="Start date is required";return}if(!r.end_date){m.value="End date is required";return}if(w(r.end_date).isBefore(r.start_date)){m.value="End date must be after start date";return}r.put(route("date-type-ranges.update",r.id),{preserveScroll:!0,onSuccess:()=>{D.value=!1,r.reset(),R.fire({icon:"success",title:"Success",text:"Date type range updated successfully"}),C(1)},onError:a=>{a.date_type_id?m.value=a.date_type_id:a.start_date?m.value=a.start_date:a.end_date?m.value=a.end_date:a.package_id?m.value=a.package_id:m.value="Failed to update date type range. Please try again."}})},J=a=>{R.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",showConfirmButton:!0,showCloseButton:!0}).then(t=>{t.isConfirmed&&de.delete(route("date-type-ranges.destroy",a),{data:{return_to_package:!0,package_id:b.package.id},preserveState:!0,preserveScroll:!0,onSuccess:()=>{R.fire({title:"Deleted!",text:"Date type range has been deleted.",icon:"success",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),C(1)}})})},Q=()=>{x.value.push({date_type_id:"",start_date:"",end_date:""})},X=a=>{x.value.length>1&&x.value.splice(a,1)},Z=a=>{if(i.value){const t=i.value.errors.some(d=>d.index===a),s=i.value.success.some(d=>d.index===a);if(t)return"border-red-200 bg-red-50";if(s)return"border-green-200 bg-green-50"}return"border-gray-200"},F=a=>{var d;if(!i.value)return null;const t=(d=i.value.validation_errors)==null?void 0:d.find(o=>o.index===a);if(t)return t.errors.join(", ");const s=i.value.errors.find(o=>o.index===a);return s?s.message||s:null},P=a=>{if(!i.value)return null;const t=i.value.success.find(s=>s.index===a);return t?t.message:null},Y=()=>{q.value=!1,i.value=null,x.value=[{date_type_id:"",start_date:"",end_date:""}],C(1)},ee=async()=>{var a,t,s,d;E.value=!0,i.value=null;try{const o=await W.post(route("date-type-ranges.store-bulk"),{package_id:b.package.id,dateTypeRanges:x.value});i.value=o.data;const O=i.value.success.length;i.value.errors.length===0&&(Y(),R.fire({icon:"success",title:"Success!",text:`${O} date type ranges were added successfully!`,confirmButtonText:"OK"}))}catch(o){console.error("Error creating date type ranges:",o),(t=(a=o.response)==null?void 0:a.data)!=null&&t.message?o.response.data.message:(d=(s=o.response)==null?void 0:s.data)!=null&&d.errors&&Object.values(o.response.data.errors).flat().join(", ")}finally{E.value=!1}};return(a,t)=>(l(),n("div",re,[e("div",le,[t[10]||(t[10]=e("h3",{class:"text-md font-medium text-gray-900"},"Date Types Ranges",-1)),e("button",{onClick:t[0]||(t[0]=s=>k.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs hidden"}," Add Date Type Range "),e("button",{onClick:t[1]||(t[1]=s=>q.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Date Type Ranges ")]),e("div",ne,[e("table",ie,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Start Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"End Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ue,[(l(!0),n(S,null,B(f.value.data,s=>{var d;return l(),n("tr",{key:s.id},[e("td",ce,g((d=s.date_type)==null?void 0:d.name),1),e("td",pe,g(u(w)(s.start_date).format("DD/MM/YYYY")),1),e("td",ge,g(u(w)(s.end_date).format("DD/MM/YYYY")),1),e("td",me,[e("button",{onClick:o=>G(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,_e),e("button",{onClick:o=>J(s.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ye)])])}),128)),f.value.data.length===0?(l(),n("tr",fe,t[11]||(t[11]=[e("td",{colspan:"4",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"},"No date type ranges found",-1)]))):v("",!0)])])]),e("div",ve,[(l(),se(oe,{links:M.value.links,from:M.value.from,to:M.value.to,total:M.value.total,"component-loading":!0,onPageChange:C,key:L.value},null,8,["links","from","to","total"]))]),V(A,{show:k.value,onClose:t[6]||(t[6]=()=>{k.value=!1,u(c).reset(),p.value.value=""})},{default:U(()=>[e("div",be,[t[17]||(t[17]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Date Type Range",-1)),p.value?(l(),n("div",xe,g(p.value),1)):v("",!0),e("form",{onSubmit:$(I,["prevent"])},[e("div",ke,[e("div",null,[t[14]||(t[14]=e("label",{for:"date_type_id",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),y(e("select",{id:"date_type_id","onUpdate:modelValue":t[2]||(t[2]=s=>u(c).date_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[13]||(t[13]=e("option",{value:""},"Select a date type",-1)),(l(!0),n(S,null,B(T.dateTypes,s=>(l(),n("option",{key:s.id,value:s.id},g(s.name),9,he))),128))],512),[[j,u(c).date_type_id]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),y(e("input",{type:"date",id:"start_date","onUpdate:modelValue":t[3]||(t[3]=s=>u(c).start_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[h,u(c).start_date]])]),e("div",null,[t[16]||(t[16]=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),y(e("input",{type:"date",id:"end_date","onUpdate:modelValue":t[4]||(t[4]=s=>u(c).end_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[h,u(c).end_date]])])]),e("div",we,[e("button",{type:"button",onClick:t[5]||(t[5]=()=>{k.value=!1,u(c).reset(),p.value.value=""}),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:u(c).processing}," Create Date Type Range ",8,De)])],32)])]),_:1},8,["show"]),V(A,{show:D.value,onClose:z},{default:U(()=>[e("div",Ce,[t[22]||(t[22]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Date Type Range",-1)),m.value?(l(),n("div",Se,g(m.value),1)):v("",!0),e("form",{onSubmit:$(H,["prevent"])},[e("div",Be,[e("div",null,[t[19]||(t[19]=e("label",{for:"edit_date_type_id",class:"block text-sm font-medium text-gray-700"},"Date Type",-1)),y(e("select",{id:"edit_date_type_id","onUpdate:modelValue":t[7]||(t[7]=s=>u(r).date_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[18]||(t[18]=e("option",{value:""},"Select a date type",-1)),(l(!0),n(S,null,B(T.dateTypes,s=>(l(),n("option",{key:s.id,value:s.id},g(s.name),9,Re))),128))],512),[[j,u(r).date_type_id]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),y(e("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":t[8]||(t[8]=s=>u(r).start_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[h,u(r).start_date]])]),e("div",null,[t[21]||(t[21]=e("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),y(e("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":t[9]||(t[9]=s=>u(r).end_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[h,u(r).end_date]])])]),e("div",Te,[e("button",{type:"button",onClick:z,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:u(r).processing}," Update Date Type Range ",8,Ee)])],32)])]),_:1},8,["show"]),V(A,{show:q.value,onClose:Y},{default:U(()=>[e("div",Me,[e("div",{class:"flex justify-between items-center mb-4"},[t[23]||(t[23]=e("h2",{class:"text-lg font-medium text-gray-900"},"Add Date Type Ranges",-1)),e("button",{type:"button",onClick:Q,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-xs"}," + Add Row ")]),i.value?(l(),n("div",qe,[e("div",Ye,[t[26]||(t[26]=e("h3",{class:"text-md font-medium text-gray-900 mb-3"},"Results Summary",-1)),e("div",Ve,[i.value.success.length>0?(l(),n("div",Ue,[e("div",$e,[t[24]||(t[24]=e("svg",{class:"h-5 w-5 text-green-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),e("span",je,g(i.value.success.length)+" date type ranges created successfully ",1)])])):v("",!0),i.value.errors.length>0?(l(),n("div",Ae,[e("div",Le,[t[25]||(t[25]=e("svg",{class:"h-5 w-5 text-red-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("span",ze,g(i.value.errors.length)+" date type ranges failed to create ",1)])])):v("",!0)])])])):v("",!0),e("form",{onSubmit:$(ee,["prevent"])},[e("div",Fe,[(l(!0),n(S,null,B(x.value,(s,d)=>(l(),n("div",{key:d,class:ae(["border rounded-lg p-4",Z(d)])},[e("div",Pe,[e("h3",Oe,"Date Type Range "+g(d+1),1),e("div",Ne,[e("button",{type:"button",onClick:o=>X(d),class:"px-3 py-1 bg-red-100 text-red-700 rounded-md hover:bg-red-200 text-sm",disabled:x.value.length===1}," Remove ",8,Ke)])]),F(d)?(l(),n("div",We,[e("div",Ie,[t[27]||(t[27]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Ge,[e("p",He,g(F(d)),1)])])])):v("",!0),P(d)?(l(),n("div",Je,[e("div",Qe,[t[28]||(t[28]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",Xe,[e("p",Ze,g(P(d)),1)])])])):v("",!0),e("div",et,[e("div",null,[e("label",{for:`bulk_date_type_id_${d}`,class:"block text-sm font-medium text-gray-700"},"Date Type",8,tt),y(e("select",{id:`bulk_date_type_id_${d}`,"onUpdate:modelValue":o=>s.date_type_id=o,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[29]||(t[29]=e("option",{value:""},"Select a date type",-1)),(l(!0),n(S,null,B(T.dateTypes,o=>(l(),n("option",{key:o.id,value:o.id},g(o.name),9,at))),128))],8,st),[[j,s.date_type_id]])]),e("div",null,[e("label",{for:`bulk_start_date_${d}`,class:"block text-sm font-medium text-gray-700"},"Start Date",8,dt),y(e("input",{type:"date",id:`bulk_start_date_${d}`,"onUpdate:modelValue":o=>s.start_date=o,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,8,ot),[[h,s.start_date]])]),e("div",null,[e("label",{for:`bulk_end_date_${d}`,class:"block text-sm font-medium text-gray-700"},"End Date",8,rt),y(e("input",{type:"date",id:`bulk_end_date_${d}`,"onUpdate:modelValue":o=>s.end_date=o,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,8,lt),[[h,s.end_date]])])])],2))),128))]),e("div",nt,[e("button",{type:"button",onClick:Y,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:E.value},g(E.value?"Creating Date Type Ranges...":"Create"),9,it)])],32)])]),_:1},8,["show"])]))}};export{vt as default};
