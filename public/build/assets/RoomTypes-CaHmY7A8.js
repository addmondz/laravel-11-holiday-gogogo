import{l as w,i as oe,C as V,M as G,g as u,o as d,b as t,h as T,a as K,F as A,q as U,c as se,w as W,t as j,e as H,j as C,u as n,k as R,x as O,W as J}from"./app-Cjw1nfAv.js";import{_ as X}from"./Modal.vue_vue_type_script_setup_true_lang-CbYajD2n.js";import{P as ae}from"./Pagination-B2ewutCw.js";import{S as h}from"./sweetalert2.esm.all-B0Dix5B2.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./LoadingComponent-CQw6PRe7.js";const ie={class:"space-y-6",style:{position:"relative"}},ne={class:"flex justify-between items-center"},le={class:"overflow-x-auto"},de={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},ce={key:0,class:"flex space-x-2"},pe=["src","onClick"],ge={key:1,class:"text-gray-400 text-sm"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},xe={class:"px-6 py-4 text-sm text-gray-900"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},be=["onClick"],ke=["onClick"],he={key:1},_e={key:0,class:"mt-4"},we={class:"p-6"},Ce={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Re={class:"space-y-4"},Be={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},Fe={class:"space-y-1 text-center"},Te={class:"text-sm text-gray-600"},je={for:"images",class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},Me={key:0,class:"mt-4 grid grid-cols-3 gap-4"},Ae=["src"],Ue=["onClick"],$e={class:"mt-6 flex justify-end space-x-3"},Ie=["disabled"],Ee={class:"p-6"},Ne={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Oe={class:"space-y-4"},Se={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},De={class:"space-y-1 text-center"},Le={class:"text-sm text-gray-600"},qe={for:"edit_images",class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},Pe={key:0,class:"mt-4 grid grid-cols-3 gap-4"},Ve=["src"],Ge=["onClick"],Ke={class:"mt-6 flex justify-end space-x-3"},We=["disabled"],He={__name:"RoomTypes",props:{package:{type:Object,required:!0},roomTypes:{type:Object,required:!0,default:()=>({data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10})}},setup(Y){const k=Y,S=w(0),v=w(k.roomTypes||{data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10}),_=w(!1),B=w(!1),p=w(""),f=w(""),M=oe(()=>({links:v.value.links,from:v.value.from,to:v.value.to,total:v.value.total})),r=V({name:"",description:"",max_occupancy:4,package_id:k.package.id,return_to_package:!0,images:[],delete_images:[]}),a=V({id:null,name:"",description:"",max_occupancy:4,package_id:k.package.id,return_to_package:!0,images:[],delete_images:[]});G(_,o=>{o||(p.value="")}),G(B,o=>{o||(f.value="")});const $=async o=>{try{const e=await O.get(route("packages.room-types",k.package.id),{params:{page:o}});v.value={...v.value,data:e.data.data,links:e.data.links,from:e.data.from,to:e.data.to,total:e.data.total,current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page},S.value++}catch(e){console.error("Error fetching room types:",e)}},z=()=>{var y,g;if(!((y=r.name)!=null&&y.trim())){p.value="Room type name is required";return}if(!r.max_occupancy||r.max_occupancy<1){p.value="Maximum occupancy must be at least 1";return}const o=new FormData;o.append("name",r.name.trim()),o.append("description",((g=r.description)==null?void 0:g.trim())||""),o.append("max_occupancy",r.max_occupancy),o.append("package_id",k.package.id),o.append("return_to_package","true"),r.images.some(l=>l instanceof File)&&r.images.forEach((l,i)=>{l instanceof File&&o.append(`images[${i}]`,l)}),O.post(route("room-types.store"),o,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then(l=>{r.processing=!1,_.value=!1,h.fire({icon:"success",title:"Success",text:"Room type created successfully"}),r.reset(),J.get(route("packages.show",k.package.id))}).catch(l=>{var i,s,m,b;if(r.processing=!1,(s=(i=l.response)==null?void 0:i.data)!=null&&s.errors){const c=l.response.data.errors;if(c.images)p.value=Array.isArray(c.images)?c.images.join(", "):c.images;else if(c.name)p.value=c.name[0];else if(c.max_occupancy)p.value=c.max_occupancy[0];else if(c.package_id)p.value=c.package_id[0];else{const x=Object.entries(c).map(([E,F])=>`${E}: ${Array.isArray(F)?F.join(", "):F}`).join(`
`);p.value=x}}else(b=(m=l.response)==null?void 0:m.data)!=null&&b.message?p.value=l.response.data.message:p.value="Failed to create room type. Please try again."}).finally(()=>{r.processing=!1})},Q=o=>{a.reset(),a.id=o.id,a.name=o.name||"",a.description=o.description||"",a.max_occupancy=parseInt(o.max_occupancy)||2,a.package_id=parseInt(k.package.id),a.images=Array.isArray(o.images)?[...o.images]:[],a.delete_images=[],a.return_to_package=!0,B.value=!0},D=()=>{B.value=!1,a.reset(),f.value=""},Z=()=>{var g,l;if(!((g=a.name)!=null&&g.trim())){f.value="Room type name is required";return}if(!a.max_occupancy||a.max_occupancy<1){f.value="Maximum occupancy must be at least 1";return}const o=new FormData;o.append("_method","PUT"),o.append("name",a.name.trim()),o.append("description",((l=a.description)==null?void 0:l.trim())||""),o.append("max_occupancy",a.max_occupancy),o.append("package_id",k.package.id),o.append("return_to_package","true");const e=a.images.some(i=>i instanceof File),y=a.delete_images.length>0;e&&a.images.forEach((i,s)=>{i instanceof File&&o.append(`images[${s}]`,i)}),y&&a.delete_images.forEach((i,s)=>{o.append(`delete_images[${s}]`,i)}),O.post(route("room-types.update",a.id),o,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then(i=>{a.processing=!1,B.value=!1,h.fire({icon:"success",title:"Success",text:"Room type updated successfully"}),a.reset(),$(1)}).catch(i=>{var s,m,b,c;if(a.processing=!1,(m=(s=i.response)==null?void 0:s.data)!=null&&m.errors){const x=i.response.data.errors;if(x.images)f.value=Array.isArray(x.images)?x.images.join(", "):x.images;else if(x.name)f.value=x.name[0];else if(x.max_occupancy)f.value=x.max_occupancy[0];else if(x.package_id)f.value=x.package_id[0];else{const E=Object.entries(x).map(([F,N])=>`${F}: ${Array.isArray(N)?N.join(", "):N}`).join(`
`);f.value=E}}else(c=(b=i.response)==null?void 0:b.data)!=null&&c.message?f.value=i.response.data.message:f.value="Failed to update room type. Please try again."}).finally(()=>{a.processing=!1})},ee=o=>{h.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",showConfirmButton:!0,showCloseButton:!0}).then(e=>{e.isConfirmed&&J.delete(route("room-types.destroy",o),{data:{return_to_package:!0},preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.fire({title:"Deleted!",text:"Room type has been deleted.",icon:"success",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),$(1)}})})},L=(o,e)=>{const y=Array.from(o.target.files),g=e==="roomTypeForm"?r:a,l=y.filter(i=>i.type.startsWith("image/")?i.size>2*1024*1024?(h.fire({icon:"error",title:"File Too Large",text:`${i.name} is larger than 2MB.`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),!1):!0:(h.fire({icon:"error",title:"Invalid File Type",text:`${i.name} is not an image file.`,showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),!1));g.images=[...g.images,...l]},q=(o,e)=>{const y=e==="roomTypeForm"?r:a,g=y.images[o];typeof g=="string"&&y.delete_images.push(g),y.images.splice(o,1)},I=o=>o.startsWith("images/")?`/${o}`:o.startsWith("room-types/")?`/images/${o}`:`/images/${o}`,P=o=>typeof o=="string"?I(o):typeof window<"u"&&window.URL&&window.URL.createObjectURL?URL.createObjectURL(o):"",te=o=>{h.fire({imageUrl:I(o),imageAlt:"Room image",showConfirmButton:!1,showCloseButton:!0,customClass:{container:"image-modal",popup:"max-w-4xl",closeButton:"text-gray-500 hover:text-gray-700",image:"max-h-[80vh] object-contain"},background:"#f8f9fa",padding:"1rem",width:"auto",backdrop:"rgba(0,0,0,0.8)"})};return(o,e)=>{var y,g,l,i;return d(),u("div",ie,[t("div",ne,[e[11]||(e[11]=t("h3",{class:"text-md font-medium text-gray-900"},"Room Types",-1)),t("button",{onClick:e[0]||(e[0]=s=>_.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Room Type ")]),t("div",le,[t("table",de,[e[13]||(e[13]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Images"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Max Occupancy"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ue,[((g=(y=v.value)==null?void 0:y.data)==null?void 0:g.length)>0?(d(!0),u(A,{key:0},U(v.value.data,s=>(d(),u("tr",{key:s.id},[t("td",me,[s.images&&s.images.length>0?(d(),u("div",ce,[(d(!0),u(A,null,U(s.images,(m,b)=>(d(),u("div",{key:b,class:"relative"},[t("img",{src:I(m),class:"h-16 w-16 object-cover rounded-lg cursor-pointer",onClick:c=>te(m),alt:"Room type image"},null,8,pe)]))),128))])):(d(),u("span",ge,"No images"))]),t("td",fe,j(s.name),1),t("td",ye,j(s.max_occupancy),1),t("td",xe,j(s.description),1),t("td",ve,[t("button",{onClick:m=>Q(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,be),t("button",{onClick:m=>ee(s.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ke)])]))),128)):(d(),u("tr",he,e[12]||(e[12]=[t("td",{colspan:"5",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"},"No room types found",-1)])))])])]),((i=(l=v.value)==null?void 0:l.links)==null?void 0:i.length)>0?(d(),u("div",_e,[(d(),se(ae,{links:M.value.links,from:M.value.from,to:M.value.to,total:M.value.total,"component-loading":!0,onPageChange:$,key:S.value},null,8,["links","from","to","total"]))])):T("",!0),K(X,{show:_.value,onClose:e[6]||(e[6]=()=>{_.value=!1,n(r).reset(),p.value.value=""})},{default:W(()=>[t("div",we,[e[23]||(e[23]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Room Type",-1)),p.value?(d(),u("div",Ce,j(p.value),1)):T("",!0),t("form",{onSubmit:H(z,["prevent"])},[t("div",Re,[t("div",null,[e[14]||(e[14]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),C(t("input",{type:"text",id:"name","onUpdate:modelValue":e[1]||(e[1]=s=>n(r).name=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[R,n(r).name]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"max_occupancy",class:"block text-sm font-medium text-gray-700"},"Max Occupancy",-1)),C(t("input",{type:"number",id:"max_occupancy","onUpdate:modelValue":e[2]||(e[2]=s=>n(r).max_occupancy=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"1",required:""},null,512),[[R,n(r).max_occupancy]])]),t("div",null,[e[16]||(e[16]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),C(t("textarea",{id:"description","onUpdate:modelValue":e[3]||(e[3]=s=>n(r).description=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3"},null,512),[[R,n(r).description]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Images",-1)),t("div",Be,[t("div",Fe,[e[19]||(e[19]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[t("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),t("div",Te,[t("label",je,[e[17]||(e[17]=t("span",null,"Upload images",-1)),t("input",{id:"images",type:"file",multiple:"",accept:"image/*",class:"sr-only",onChange:e[4]||(e[4]=s=>L(s,"roomTypeForm"))},null,32)]),e[18]||(e[18]=t("p",{class:"pl-1"},"or drag and drop",-1))]),e[20]||(e[20]=t("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 2MB each",-1))])]),n(r).images.length>0?(d(),u("div",Me,[(d(!0),u(A,null,U(n(r).images,(s,m)=>(d(),u("div",{key:m,class:"relative"},[t("img",{src:P(s),class:"h-24 w-full object-cover rounded-lg",alt:"Room type image"},null,8,Ae),t("button",{type:"button",onClick:b=>q(m,"roomTypeForm"),class:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},e[21]||(e[21]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ue)]))),128))])):T("",!0)])]),t("div",$e,[t("button",{type:"button",onClick:e[5]||(e[5]=()=>{_.value=!1,n(r).reset(),p.value.value=""}),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:n(r).processing}," Create Room Type ",8,Ie)])],32)])]),_:1},8,["show"]),K(X,{show:B.value,onClose:D},{default:W(()=>[t("div",Ee,[e[33]||(e[33]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Room Type",-1)),f.value?(d(),u("div",Ne,j(f.value),1)):T("",!0),t("form",{onSubmit:H(Z,["prevent"])},[t("div",Oe,[t("div",null,[e[24]||(e[24]=t("label",{for:"edit_name",class:"block text-sm font-medium text-gray-700"},"Name",-1)),C(t("input",{type:"text",id:"edit_name","onUpdate:modelValue":e[7]||(e[7]=s=>n(a).name=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[R,n(a).name]])]),t("div",null,[e[25]||(e[25]=t("label",{for:"edit_max_occupancy",class:"block text-sm font-medium text-gray-700"},"Max Occupancy",-1)),C(t("input",{type:"number",id:"edit_max_occupancy","onUpdate:modelValue":e[8]||(e[8]=s=>n(a).max_occupancy=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"1",required:""},null,512),[[R,n(a).max_occupancy]])]),t("div",null,[e[26]||(e[26]=t("label",{for:"edit_description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),C(t("textarea",{id:"edit_description","onUpdate:modelValue":e[9]||(e[9]=s=>n(a).description=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3"},null,512),[[R,n(a).description]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700"},"Images",-1)),t("div",Se,[t("div",De,[e[29]||(e[29]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[t("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),t("div",Le,[t("label",qe,[e[27]||(e[27]=t("span",null,"Upload images",-1)),t("input",{id:"edit_images",type:"file",multiple:"",accept:"image/*",class:"sr-only",onChange:e[10]||(e[10]=s=>L(s,"editRoomTypeForm"))},null,32)]),e[28]||(e[28]=t("p",{class:"pl-1"},"or drag and drop",-1))]),e[30]||(e[30]=t("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 2MB each",-1))])]),n(a).images.length>0?(d(),u("div",Pe,[(d(!0),u(A,null,U(n(a).images,(s,m)=>(d(),u("div",{key:m,class:"relative"},[t("img",{src:P(s),class:"h-24 w-full object-cover rounded-lg",alt:"Room type image"},null,8,Ve),t("button",{type:"button",onClick:b=>q(m,"editRoomTypeForm"),class:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},e[31]||(e[31]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ge)]))),128))])):T("",!0)])]),t("div",Ke,[t("button",{type:"button",onClick:D,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:n(a).processing}," Update Room Type ",8,We)])],32)])]),_:1},8,["show"])])}}},et=re(He,[["__scopeId","data-v-c47d8603"]]);export{et as default};
