import{l as f,i as se,C as K,z as W,g as n,o as d,b as e,h as k,a as j,F as D,s as T,c as oe,w as A,t as p,e as L,j as x,u,q as z,k as B,n as ae,y as I,W as de}from"./app-oI5Bu5d3.js";import{_ as F}from"./Modal.vue_vue_type_script_setup_true_lang-DTeKfufn.js";import{P as le}from"./Pagination-DQtCxVq_.js";import{S as E}from"./sweetalert2.esm.all-B0Dix5B2.js";import{h as V}from"./moment-C5S46NFB.js";import"./LoadingComponent-BpjGMBTh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"space-y-6"},re={class:"flex justify-between items-center"},ie={class:"flex space-x-2"},ue={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},pe={class:"bg-white divide-y divide-gray-200"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},me={class:"px-6 py-4 text-sm text-gray-900"},_e={class:"px-6 py-4 text-sm text-gray-900"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},fe=["onClick"],ye=["onClick"],be={key:1},xe={key:0,class:"mt-4"},ke={class:"p-6"},he={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},we={class:"space-y-4"},Se=["value"],Ce={class:"mt-6 flex justify-end space-x-3"},Be=["disabled"],Me={class:"p-6"},De={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Te={class:"space-y-4"},Ee=["value"],Ye={class:"mt-6 flex justify-end space-x-3"},qe=["disabled"],Ve={class:"p-6"},Ue={key:0,class:"mb-4"},$e={class:"bg-gray-50 rounded-lg p-4"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ae={key:0,class:"bg-green-50 border border-green-200 rounded-md p-3"},Le={class:"flex items-center"},ze={class:"text-sm font-medium text-green-800"},Fe={key:1,class:"bg-red-50 border border-red-200 rounded-md p-3"},Pe={class:"flex items-center"},Re={class:"text-sm font-medium text-red-800"},Ne={class:"space-y-4"},Oe={class:"flex justify-between items-center mb-4"},Ke={class:"text-md font-medium text-gray-900 invisible"},We={class:"flex space-x-2"},Ie=["onClick","disabled"],Ge={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},He={class:"flex"},Je={class:"ml-3"},Qe={class:"text-sm text-red-800"},Xe={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md"},Ze={class:"flex"},et={class:"ml-3"},tt={class:"text-sm text-green-800"},st={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ot=["for"],at=["id","onUpdate:modelValue"],dt=["value"],lt=["for"],nt=["id","onUpdate:modelValue"],rt=["for"],it=["id","onUpdate:modelValue"],ut={class:"mt-6 flex justify-end space-x-3"},ct=["disabled"],bt={__name:"SeasonTypes",props:{package:{type:Object,required:!0},seasons:{type:Object,required:!0,default:()=>({data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10})},seasonTypes:{type:Array,required:!0,default:()=>[]}},setup(h){const w=h,P=f(0),_=f(w.seasons||{data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10}),S=f(!1),M=f(!1),U=f(!1),g=f(""),y=f(""),Y=f(!1),r=f(null),b=f([{season_type_id:"",start_date:"",end_date:""}]),q=se(()=>({links:_.value.links,from:_.value.from,to:_.value.to,total:_.value.total})),c=K({season_type_id:"",start_date:"",end_date:"",package_id:w.package.id,return_to_package:!0}),i=K({id:null,season_id:"",start_date:"",end_date:"",package_id:w.package.id,season_type_id:"",return_to_package:!0});W(S,o=>{o||(g.value="")}),W(M,o=>{o||(y.value="")});const C=async o=>{try{const a=(await I.get(route("packages.seasons",w.package.id),{params:{page:o}})).data;_.value.data=a.data,_.value.links=a.links,_.value.from=a.from,_.value.to=a.to,_.value.total=a.total,_.value.current_page=a.current_page,_.value.last_page=a.last_page,_.value.per_page=a.per_page,P.value++}catch(t){console.error("Error fetching season types:",t)}},G=()=>{if(!c.season_type_id){g.value="Season type is required";return}if(!c.start_date){g.value="Start date is required";return}if(!c.end_date){g.value="End date is required";return}c.post(route("seasons.store"),{preserveScroll:!0,onSuccess:()=>{S.value=!1,c.reset(),E.fire({icon:"success",title:"Success",text:"Season created successfully"}),C(1)},onError:o=>{o.season_type_id?g.value=o.season_type_id:o.start_date?g.value=o.start_date:o.end_date?g.value=o.end_date:o.date_range?g.value=o.date_range:g.value="Failed to create season. Please try again."}})},H=o=>{i.reset(),i.id=o.id,i.season_type_id=o.season_type_id,i.start_date=V(o.start_date).format("YYYY-MM-DD"),i.end_date=V(o.end_date).format("YYYY-MM-DD"),i.package_id=parseInt(w.package.id),i.return_to_package=!0,M.value=!0},R=()=>{M.value=!1,i.reset(),y.value=""},J=()=>{i.put(route("seasons.update",i.id),{preserveScroll:!0,onSuccess:()=>{M.value=!1,i.reset(),E.fire({icon:"success",title:"Success",text:"Season type updated successfully"}),C(1)},onError:o=>{console.log(o),o.season_type_id?y.value=o.season_type_id:o.start_date?y.value=o.start_date:o.end_date?y.value=o.end_date:o.date_range?y.value=o.date_range:y.value="Failed to update season type. Please try again."}})},Q=o=>{E.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",showConfirmButton:!0,showCloseButton:!0}).then(t=>{t.isConfirmed&&de.delete(route("seasons.destroy",o),{data:{return_to_package:!0,package_id:w.package.id},preserveState:!0,preserveScroll:!0,onSuccess:()=>{E.fire({title:"Deleted!",text:"Season type has been deleted.",icon:"success",showConfirmButton:!0,confirmButtonText:"OK",confirmButtonColor:"#4F46E5"}),C(1)}})})},X=()=>{b.value.push({season_type_id:"",start_date:"",end_date:""})},Z=o=>{b.value.length>1&&b.value.splice(o,1)},ee=o=>{if(r.value){const t=r.value.errors.some(v=>v.index===o),a=r.value.success.some(v=>v.index===o);if(t)return"border-red-200 bg-red-50";if(a)return"border-green-200 bg-green-50"}return"border-gray-200"},N=o=>{var v;if(!r.value)return null;const t=(v=r.value.validation_errors)==null?void 0:v.find(s=>s.index===o);if(t)return t.errors.join(", ");const a=r.value.errors.find(s=>s.index===o);return a?a.message||a:null},O=o=>{if(!r.value)return null;const t=r.value.success.find(a=>a.index===o);return t?t.message:null},$=()=>{U.value=!1,r.value=null,b.value=[{season_type_id:"",start_date:"",end_date:""}],C(1)},te=async()=>{var o,t,a,v;Y.value=!0,r.value=null,b.value=b.value.filter(s=>!s.success);try{const s=await I.post(route("seasons.store-bulk"),{package_id:w.package.id,seasons:b.value});r.value=s.data;const l=r.value.success.length,m=r.value.errors.length;m===0?($(),E.fire({icon:"success",title:"Success!",text:`${l} seasons were added successfully!`,confirmButtonText:"OK"}),C(1)):l===0||partialSuccess(l,m)}catch(s){console.error("Error creating seasons:",s),(t=(o=s.response)==null?void 0:o.data)!=null&&t.message?s.response.data.message:(v=(a=s.response)==null?void 0:a.data)!=null&&v.errors&&Object.values(s.response.data.errors).flat().join(", ")}finally{Y.value=!1}};return(o,t)=>{var a,v;return d(),n("div",ne,[e("div",re,[t[10]||(t[10]=e("h3",{class:"text-md font-medium text-gray-900"},"Season Types",-1)),e("div",ie,[e("button",{onClick:t[0]||(t[0]=s=>S.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs hidden"}," Add Season "),e("button",{onClick:t[1]||(t[1]=s=>U.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Seasons ")])]),e("div",ue,[e("table",ce,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Start Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"End Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",pe,[h.seasons.data.length>0?(d(!0),n(D,{key:0},T(h.seasons.data,s=>(d(),n("tr",{key:s.id},[e("td",ge,p(s.type.name),1),e("td",me,p(u(V)(s.start_date).format("DD/MM/YYYY")),1),e("td",_e,p(u(V)(s.end_date).format("DD/MM/YYYY")),1),e("td",ve,[e("button",{onClick:l=>H(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,fe),e("button",{onClick:l=>Q(s.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,ye)])]))),128)):(d(),n("tr",be,t[11]||(t[11]=[e("td",{colspan:"3",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"},"No season types found",-1)])))])])]),((v=(a=h.seasons)==null?void 0:a.links)==null?void 0:v.length)>0?(d(),n("div",xe,[(d(),oe(le,{links:q.value.links,from:q.value.from,to:q.value.to,total:q.value.total,"component-loading":!0,onPageChange:C,key:P.value},null,8,["links","from","to","total"]))])):k("",!0),j(F,{show:S.value,onClose:t[6]||(t[6]=()=>{S.value=!1,u(c).reset(),g.value.value=""})},{default:A(()=>[e("div",ke,[t[17]||(t[17]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Season",-1)),g.value?(d(),n("div",he,p(g.value),1)):k("",!0),e("form",{onSubmit:L(G,["prevent"])},[e("div",we,[e("div",null,[t[14]||(t[14]=e("label",{for:"season_type_id",class:"block text-sm font-medium text-gray-700"},"Season Type",-1)),x(e("select",{id:"season_type_id","onUpdate:modelValue":t[2]||(t[2]=s=>u(c).season_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[13]||(t[13]=e("option",{value:""},"Select a season type",-1)),(d(!0),n(D,null,T(h.seasonTypes,s=>(d(),n("option",{key:s.id,value:s.id},p(s.name),9,Se))),128))],512),[[z,u(c).season_type_id]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"start_date","onUpdate:modelValue":t[3]||(t[3]=s=>u(c).start_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[B,u(c).start_date]])]),e("div",null,[t[16]||(t[16]=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"end_date","onUpdate:modelValue":t[4]||(t[4]=s=>u(c).end_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[B,u(c).end_date]])])]),e("div",Ce,[e("button",{type:"button",onClick:t[5]||(t[5]=()=>{S.value=!1,u(c).reset(),g.value.value=""}),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:u(c).processing}," Create Season ",8,Be)])],32)])]),_:1},8,["show"]),j(F,{show:M.value,onClose:R},{default:A(()=>[e("div",Me,[t[22]||(t[22]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Season Type",-1)),y.value?(d(),n("div",De,p(y.value),1)):k("",!0),e("form",{onSubmit:L(J,["prevent"])},[e("div",Te,[e("div",null,[t[19]||(t[19]=e("label",{for:"edit_season_type_id",class:"block text-sm font-medium text-gray-700"},"Season Type",-1)),x(e("select",{id:"edit_season_type_id","onUpdate:modelValue":t[7]||(t[7]=s=>u(i).season_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[18]||(t[18]=e("option",{value:""},"Select a season type",-1)),(d(!0),n(D,null,T(h.seasonTypes,s=>(d(),n("option",{key:s.id,value:s.id},p(s.name),9,Ee))),128))],512),[[z,u(i).season_type_id]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":t[8]||(t[8]=s=>u(i).start_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[B,u(i).start_date]])]),e("div",null,[t[21]||(t[21]=e("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":t[9]||(t[9]=s=>u(i).end_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,512),[[B,u(i).end_date]])])]),e("div",Ye,[e("button",{type:"button",onClick:R,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:u(i).processing}," Update Season Type ",8,qe)])],32)])]),_:1},8,["show"]),j(F,{show:U.value,onClose:$},{default:A(()=>[e("div",Ve,[e("div",{class:"flex justify-between items-center mb-4"},[t[23]||(t[23]=e("h2",{class:"text-lg font-medium text-gray-900"},"Add Seasons",-1)),e("button",{type:"button",onClick:X,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-xs"}," + Add Row ")]),r.value?(d(),n("div",Ue,[e("div",$e,[t[26]||(t[26]=e("h3",{class:"text-md font-medium text-gray-900 mb-3"},"Results Summary",-1)),e("div",je,[r.value.success.length>0?(d(),n("div",Ae,[e("div",Le,[t[24]||(t[24]=e("svg",{class:"h-5 w-5 text-green-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),e("span",ze,p(r.value.success.length)+" seasons created successfully ",1)])])):k("",!0),r.value.errors.length>0?(d(),n("div",Fe,[e("div",Pe,[t[25]||(t[25]=e("svg",{class:"h-5 w-5 text-red-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("span",Re,p(r.value.errors.length)+" seasons failed to create ",1)])])):k("",!0)])])])):k("",!0),e("form",{onSubmit:L(te,["prevent"])},[e("div",Ne,[(d(!0),n(D,null,T(b.value,(s,l)=>(d(),n("div",{key:l,class:ae(["border rounded-lg p-4",ee(l)])},[e("div",Oe,[e("h3",Ke,"Season "+p(l+1),1),e("div",We,[e("button",{type:"button",onClick:m=>Z(l),class:"px-3 py-1 bg-red-100 text-red-700 rounded-md hover:bg-red-200 text-sm",disabled:b.value.length===1}," Remove ",8,Ie)])]),N(l)?(d(),n("div",Ge,[e("div",He,[t[27]||(t[27]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Je,[e("p",Qe,p(N(l)),1)])])])):k("",!0),O(l)?(d(),n("div",Xe,[e("div",Ze,[t[28]||(t[28]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",et,[e("p",tt,p(O(l)),1)])])])):k("",!0),e("div",st,[e("div",null,[e("label",{for:`bulk_season_type_id_${l}`,class:"block text-sm font-medium text-gray-700"},"Season Type",8,ot),x(e("select",{id:`bulk_season_type_id_${l}`,"onUpdate:modelValue":m=>s.season_type_id=m,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[29]||(t[29]=e("option",{value:""},"Select a season type",-1)),(d(!0),n(D,null,T(h.seasonTypes,m=>(d(),n("option",{key:m.id,value:m.id},p(m.name),9,dt))),128))],8,at),[[z,s.season_type_id]])]),e("div",null,[e("label",{for:`bulk_start_date_${l}`,class:"block text-sm font-medium text-gray-700"},"Start Date",8,lt),x(e("input",{type:"date",id:`bulk_start_date_${l}`,"onUpdate:modelValue":m=>s.start_date=m,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,8,nt),[[B,s.start_date]])]),e("div",null,[e("label",{for:`bulk_end_date_${l}`,class:"block text-sm font-medium text-gray-700"},"End Date",8,rt),x(e("input",{type:"date",id:`bulk_end_date_${l}`,"onUpdate:modelValue":m=>s.end_date=m,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},null,8,it),[[B,s.end_date]])])])],2))),128))]),e("div",ut,[e("button",{type:"button",onClick:$,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:Y.value},p(Y.value?"Creating Seasons...":"Create"),9,ct)])],32)])]),_:1},8,["show"])])}}};export{bt as default};
