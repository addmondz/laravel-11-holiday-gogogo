import{l as p,C as F,q as T,g as i,o as l,b as e,a as C,h as g,F as z,p as K,c as G,w as A,e as V,j as x,n as _,u as r,k as y,t as m,L as q}from"./app-BgZlRyz4.js";import{_ as j}from"./Modal.vue_vue_type_script_setup_true_lang-D4HxeK4G.js";import{P as H}from"./Pagination-IUzcwwNQ.js";import{h as b}from"./moment-C5S46NFB.js";import{S as c}from"./sweetalert2.esm.all-DWO__QVt.js";import{L as J}from"./LoadingComponent-B1GoE13d.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"space-y-6"},W={class:"flex justify-between items-center"},X={class:"overflow-x-auto"},Z={key:0,class:"flex justify-center items-center h-full min-h-[400px]"},ee={key:1,class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ae=["onClick"],de=["onClick"],ne={key:0},le={class:"mt-4"},ie={class:"p-6"},ce={class:"grid grid-cols-1 gap-6"},ue={key:0,class:"mt-1 text-sm text-red-600"},me={key:0,class:"mt-1 text-sm text-red-600"},pe={class:"mt-6 flex justify-end space-x-3"},ge=["disabled"],fe={class:"p-6"},xe={class:"grid grid-cols-1 gap-6"},_e={key:0,class:"mt-1 text-sm text-red-600"},ye={key:0,class:"mt-1 text-sm text-red-600"},be={class:"mt-6 flex justify-end space-x-3"},ve=["disabled"],ke={__name:"DateBlockers",props:{packageId:{type:Number,required:!0}},setup(L){const D=L,n=p({data:[],links:[],from:0,to:0,total:0,current_page:1,last_page:1,per_page:10}),E=p(0),v=p(!1),k=p(!1),h=p(!0),d=F({package_id:D.packageId,start_date:"",end_date:""}),s=F({id:null,start_date:"",end_date:""}),u=async(o=1)=>{try{const t=await q.get(route("date-blockers.index"),{params:{package_id:D.packageId,page:o}});n.value=t.data,h.value=!1}catch(t){console.error("Error fetching date blockers:",t),h.value=!1}},N=async o=>{try{await u(o),E.value++}catch(t){console.error("Error changing page:",t)}},U=()=>{d.post(route("date-blockers.store"),{preserveScroll:!0,onSuccess:()=>{w(),u(n.value.current_page),c.fire({title:"Success!",text:d.recentlySuccessful?"Date blocker added successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.date_range?c.fire({title:"Error!",text:o.date_range,icon:"error",confirmButtonColor:"#4F46E5"}):o.error&&c.fire({title:"Error!",text:o.error,icon:"error",confirmButtonColor:"#4F46E5"})}})},I=()=>{s.put(route("date-blockers.update",s.id),{preserveScroll:!0,onSuccess:()=>{B(),u(n.value.current_page),c.fire({title:"Success!",text:s.recentlySuccessful?"Date blocker updated successfully.":"Operation successful.",icon:"success",confirmButtonColor:"#4F46E5"})},onError:o=>{o.date_range?c.fire({title:"Error!",text:o.date_range,icon:"error",confirmButtonColor:"#4F46E5"}):o.error&&c.fire({title:"Error!",text:o.error,icon:"error",confirmButtonColor:"#4F46E5"})}})},P=async o=>{var a,f,Y,M;if((await c.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4F46E5",cancelButtonColor:"#EF4444",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await q.delete(route("date-blockers.destroy",o)),n.value.data.length===1&&n.value.current_page>1?await u(n.value.current_page-1):await u(n.value.current_page),c.fire({title:"Deleted!",text:"Date blocker has been deleted.",icon:"success",confirmButtonColor:"#4F46E5"})}catch(S){const O=((f=(a=S.response)==null?void 0:a.data)==null?void 0:f.message)||((M=(Y=S.response)==null?void 0:Y.data)==null?void 0:M.error)||"Error deleting date blocker";c.fire({title:"Error!",text:O,icon:"error",confirmButtonColor:"#4F46E5"})}},$=o=>{s.id=o.id,s.start_date=b(o.start_date).format("YYYY-MM-DD"),s.end_date=b(o.end_date).format("YYYY-MM-DD"),k.value=!0},w=()=>{v.value=!1,d.reset(),d.clearErrors()},B=()=>{k.value=!1,s.reset(),s.clearErrors()};return T(()=>{u()}),(o,t)=>(l(),i("div",R,[e("div",W,[t[5]||(t[5]=e("h3",{class:"text-md font-medium text-gray-900"},"Date Blockers",-1)),e("button",{onClick:t[0]||(t[0]=a=>v.value=!0),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs"}," Add Date Blocker ")]),e("div",X,[h.value?(l(),i("div",Z,[C(J)])):(l(),i("table",ee,[t[7]||(t[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Start Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," End Date "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",te,[(l(!0),i(z,null,K(n.value.data,a=>(l(),i("tr",{key:a.id},[e("td",re,m(r(b)(a.start_date).format("DD/MM/YYYY")),1),e("td",oe,m(r(b)(a.end_date).format("DD/MM/YYYY")),1),e("td",se,[e("button",{onClick:f=>$(a),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,ae),e("button",{onClick:f=>P(a.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,de)])]))),128)),n.value.data.length===0?(l(),i("tr",ne,t[6]||(t[6]=[e("td",{colspan:"3",class:"text-center text-gray-500 py-4 border-t border-b border-gray-300"}," No date blockers found ",-1)]))):g("",!0)])]))]),e("div",le,[(l(),G(H,{links:n.value.links,from:n.value.from,to:n.value.to,total:n.value.total,"component-loading":!0,onPageChange:N,key:E.value},null,8,["links","from","to","total"]))]),C(j,{show:v.value,onClose:w},{default:A(()=>[e("div",ie,[t[10]||(t[10]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Date Blocker",-1)),e("form",{onSubmit:V(U,["prevent"])},[e("div",ce,[e("div",null,[t[8]||(t[8]=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"start_date","onUpdate:modelValue":t[1]||(t[1]=a=>r(d).start_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.start_date}]),required:""},null,2),[[y,r(d).start_date]]),r(d).errors.start_date?(l(),i("div",ue,m(r(d).errors.start_date),1)):g("",!0)]),e("div",null,[t[9]||(t[9]=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"end_date","onUpdate:modelValue":t[2]||(t[2]=a=>r(d).end_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(d).errors.end_date}]),required:""},null,2),[[y,r(d).end_date]]),r(d).errors.end_date?(l(),i("div",me,m(r(d).errors.end_date),1)):g("",!0)])]),e("div",pe,[e("button",{type:"button",onClick:w,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(d).processing}," Add Date Blocker ",8,ge)])],32)])]),_:1},8,["show"]),C(j,{show:k.value,onClose:B},{default:A(()=>[e("div",fe,[t[13]||(t[13]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Date Blocker",-1)),e("form",{onSubmit:V(I,["prevent"])},[e("div",xe,[e("div",null,[t[11]||(t[11]=e("label",{for:"edit_start_date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(e("input",{type:"date",id:"edit_start_date","onUpdate:modelValue":t[3]||(t[3]=a=>r(s).start_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.start_date}]),required:""},null,2),[[y,r(s).start_date]]),r(s).errors.start_date?(l(),i("div",_e,m(r(s).errors.start_date),1)):g("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{for:"edit_end_date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(e("input",{type:"date",id:"edit_end_date","onUpdate:modelValue":t[4]||(t[4]=a=>r(s).end_date=a),class:_(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"border-red-500":r(s).errors.end_date}]),required:""},null,2),[[y,r(s).end_date]]),r(s).errors.end_date?(l(),i("div",ye,m(r(s).errors.end_date),1)):g("",!0)])]),e("div",be,[e("button",{type:"button",onClick:B,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs"}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",disabled:r(s).processing}," Update Date Blocker ",8,ve)])],32)])]),_:1},8,["show"])]))}},Me=Q(ke,[["__scopeId","data-v-d2f5e60f"]]);export{Me as default};
